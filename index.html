<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mini Chat ‚Äì besz√©lget≈ë t√°rs</title>
<style>
  :root{--bg:#0f1216;--card:#151a21;--ink:#e8ecf1;--muted:#a7b0bc;--accent:#7c5cff;}
  *{box-sizing:border-box} body{margin:0;background:linear-gradient(135deg,#0d1117,#111926);}
  .center{min-height:100svh;display:grid;place-items:center;padding:16px}
  .card{width:min(900px,100%);background:var(--card);border:1px solid #232b36;border-radius:20px;
        box-shadow:0 10px 30px rgba(0,0,0,.35);color:var(--ink);overflow:hidden}
  .hero{padding:28px 24px;border-bottom:1px solid #232b36;display:flex;gap:16px;align-items:center}
  .badge{padding:4px 10px;border:1px solid #303a47;border-radius:999px;font-size:12px;color:var(--muted)}
  .h1{font-size:22px;margin:4px 0 2px} .muted{color:var(--muted);font-size:14px}
  .grid{display:grid;grid-template-columns:1fr 280px;gap:16px;padding:16px}
  .stack{display:flex;flex-direction:column;gap:10px}
  label{font-size:13px;color:var(--muted)} input,textarea{width:100%;padding:12px 14px;border-radius:12px;
        border:1px solid #2a3442;background:#0f141b;color:var(--ink);outline:none}
  input:focus,textarea:focus{border-color:#3b4657;box-shadow:0 0 0 3px rgba(124,92,255,.15)}
  .row{display:flex;gap:10px;align-items:center}
  .btn{appearance:none;border:none;padding:12px 16px;border-radius:12px;background:var(--accent);color:white;
       font-weight:600;cursor:pointer}
  .btn.secondary{background:#222b36;color:var(--ink);border:1px solid #313c49}
  .btn:disabled{opacity:.6;cursor:not-allowed}
  /* chat */
  .chat{height:60svh;min-height:380px;max-height:70svh;overflow:auto;padding:16px;display:flex;flex-direction:column;gap:10px;background:#0e1319}
  .bubble{max-width:80%;padding:10px 12px;border-radius:14px;line-height:1.35;font-size:15px;white-space:pre-wrap;word-wrap:break-word}
  .bot{align-self:flex-start;background:#141b23;border:1px solid #2b3542}
  .me{align-self:flex-end;background:#1b2430;border:1px solid #334051}
  .footer{display:flex;gap:8px;padding:12px;border-top:1px solid #232b36;background:#0f141b}
  .brand{font-size:12px;color:#8b95a5}
  .typing{font-size:12px;color:#95a0b5;padding-left:6px}
  .small{font-size:12px;color:#9aa6b6}
  .hidden{display:none}
</style>
</head>
<body>
<div class="center">
  <div class="card" id="screen-welcome">
    <div class="hero">
      <div class="badge">Mini Chat</div>
      <div>
        <div class="h1">√údv a besz√©lget≈ë t√°rsn√°l</div>
        <div class="muted">Katt a kezd√©sre √©s m√°r mehet is a csevej. (Offline is m≈±k√∂dik.)</div>
      </div>
    </div>
    <div class="grid">
      <div class="stack">
        <label for="creator">Ki hozta l√©tre? (megjelenik a fejl√©cben)</label>
        <input id="creator" placeholder="pl. Horv√°th Tam√°s" />
        <label for="nickname">Hogyan sz√≥l√≠tsalak? (opcion√°lis)</label>
        <input id="nickname" placeholder="pl. Zsanett" />
        <div class="row">
          <button class="btn" id="startBtn">J√≥ sz√≥rakoz√°st ‚Ä¢ Kezd√©s</button>
          <button class="btn secondary" id="skipBtn">Kezd√©s azonnal</button>
        </div>
        <div class="small">Tipp: √≠rd be a nevedet, √©s a bot megjegyzi a besz√©lget√©s v√©g√©ig.</div>
      </div>
      <div class="stack">
        <div class="brand">Mit tud?</div>
        <div class="small">‚Ä¢ K√∂sz√∂n, small talk ‚Ä¢ Megmondja az id≈ët/d√°tumot<br>
          ‚Ä¢ Kis ‚Äûmem√≥ria‚Äù: becen√©v ‚Ä¢ Sz√°mol√°s: csak biztons√°gos m≈±veletek<br>
          ‚Ä¢ Viccek ‚Ä¢ Alap v√°laszok</div>
      </div>
    </div>
  </div>

  <div class="card hidden" id="screen-chat">
    <div class="hero">
      <div class="badge" id="brand-badge">L√©trehozta: ‚Äî</div>
      <div>
        <div class="h1">Mini Chat</div>
        <div class="muted">√çrj √ºzenetet, √©s v√°laszolok. üòä <span class="typing" id="typing"></span></div>
      </div>
    </div>
    <div class="chat" id="chat"></div>
    <div class="footer">
      <input id="input" placeholder="√çrj ide... (Enter = k√ºld√©s)" />
      <button class="btn" id="sendBtn">K√ºld√©s</button>
    </div>
  </div>
</div>

<script>
/* ====== kis ‚Äûagyi‚Äù logika (rule-based) ====== */
const state = {
  name: null,
  creator: null
};

const rnd = (...a)=>a[Math.floor(Math.random()*a.length)];

function nowText(){
  const d = new Date();
  const pad = n => String(n).padStart(2,'0');
  return `Most ${d.getFullYear()}.${pad(d.getMonth()+1)}.${pad(d.getDate())}. ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())} van.`;
}

function setNameFromText(t){
  let m = t.match(/(?:h√≠vj\s+([^,!.?:;]+?)\s*-?nek|a\s+nevem\s+([^,!.?:;]+))/i)
        || t.match(/(?:call\s+me\s+([^,!.?:;]+)|my\s+name\s+is\s+([^,!.?:;]+))/i);
  if(m){
    const name = (m[1]||m[2]||"").trim();
    if(name){ state.name = name; return name; }
  }
  return null;
}

function safeCalc(t){
  // csak sz√°mok, +-*/(). √©s sz√≥k√∂z ‚Äì semmi v√°ltoz√≥, semmi bet≈±
  const m = t.match(/(?:^|\b)(?:calc|sz√°mold\s+ki|=)?\s*([0-9+\-*/().\s]+)$/i);
  if(!m) return null;
  const expr = m[1].trim();
  if(!/^[0-9+\-*/().\s]+$/.test(expr)) return "Csak sz√°mok √©s + - * / ( ) enged√©lyezett.";
  try{
    // nagyon alap ki√©rt√©kel√©s ‚Äì csak akkor fut, ha a fenti regex √°tment
    // eslint-disable-next-line no-new-func
    const val = Function(`"use strict"; return (${expr})`)();
    if(typeof val !== "number" || !isFinite(val)) throw 0;
    return `${expr} = ${val}`;
  }catch(e){
    return "Nem tudtam kisz√°molni. Pr√≥b√°ld: calc (2+3*4)/5";
  }
}

function respond(text){
  const t = text.trim();

  // n√©v be√°ll√≠t√°s
  if(setNameFromText(t)){
    return rnd(`Ok√©, ${state.name}! Megjegyeztem.`, `Rendben, √≠gy sz√≥l√≠talak: ${state.name}.`);
  }

  // k√∂sz√∂n√©s
  if(/^(szia|hell[o√≥]|hali|cs[≈ëo])/i.test(t)){
    return state.name ? rnd(`Szia, ${state.name}!`, `Na szeva, ${state.name}!`) : rnd("Szia!", "Hell√≥!", "Cs≈ë!");
  }

  // hogy vagy?
  if(/hogy\s+vagy|how\s+are\s+you/i.test(t)){
    return state.name ? rnd(`J√≥l vagyok, ${state.name}! Te?`, `Szuper√ºl, ${state.name}. Miben seg√≠tsek?`)
                      : rnd("Megvagyok, k√∂szi! Te?", "Kir√°lyul! Mizu?");
  }

  // id≈ë/d√°tum
  if(/mennyi\s+az\s+id[≈ëo]|h[√°a]ny\s+√≥ra|d[√°a]tum|^id≈ë$|^time$/i.test(t)){
    return nowText();
  }

  // vicc
  if(/\b(vicc|po[e√©]n|joke)\b/i.test(t)){
    return rnd(
      "Mi az: z√∂ld √©s nem megy? A meg√°llott uborka.",
      "Mi√©rt ment √°t a csirke az √∫ton? Hogy a t√∫loldalon k√©rdezzen m√©g egyet.",
      "404: vicc nem tal√°lhat√≥. Pr√≥b√°ld √∫jra!"
    );
  }

  // sz√°mol√°s
  const calc = safeCalc(t);
  if(calc){ return calc; }

  // elk√∂sz√∂n√©s
  if(/\b(viszl[√°a]t|cs[a√°]o|bye|exit|quit)\b/i.test(t)){
    return rnd("Viszl√°t!", "Cs√°√≥!", "J√≥ pihen√©st!");
  }

  // alap fallback
  return rnd(
    "Ezt m√©g tanulom. Mondd m√°sk√©pp, k√©rlek!",
    "Nem vagyok biztos benne. Tudsz p√©ld√°t √≠rni?",
    "Hmm‚Ä¶ ez neh√©z. Pr√≥b√°ld r√∂videbben!"
  );
}

/* ====== UI ====== */
const $ = sel => document.querySelector(sel);
const chatEl = $("#chat"), inputEl = $("#input"), typingEl = $("#typing");

function addBubble(text, who="bot"){
  const div = document.createElement("div");
  div.className = `bubble ${who==="me"?"me":"bot"}`;
  div.textContent = text;
  chatEl.appendChild(div);
  chatEl.scrollTop = chatEl.scrollHeight;
}

function botReplyLater(text, delay=400){
  typingEl.textContent = "‚Ä¶gondolkodom";
  setTimeout(()=>{
    addBubble(text,"bot");
    typingEl.textContent = "";
  }, delay);
}

function send(){
  const v = inputEl.value.trim();
  if(!v) return;
  addBubble(v,"me");
  inputEl.value = "";
  const r = respond(v);
  botReplyLater(r, 300 + Math.min(1200, v.length*15));
}

$("#sendBtn").addEventListener("click", send);
inputEl.addEventListener("keydown", e=>{
  if(e.key === "Enter"){ send(); }
});

/* ====== k√©perny≈ë v√°lt√°s ====== */
$("#startBtn").addEventListener("click", ()=>{
  state.creator = $("#creator").value.trim() || "Ismeretlen";
  state.name = ($("#nickname").value.trim() || null);
  $("#brand-badge").textContent = `L√©trehozta: ${state.creator}`;
  $("#screen-welcome").classList.add("hidden");
  $("#screen-chat").classList.remove("hidden");
  addBubble(rnd("Szia! Kezdhetj√ºk. üòä","Hell√≥! Miben seg√≠thetek?","Cs≈ë! √çrj egy √ºzenetet."));
  if(state.name){ addBubble(`Megjegyeztem a neved: ${state.name}.`); }
});
$("#skipBtn").addEventListener("click", ()=>{
  $("#brand-badge").textContent = `L√©trehozta: ‚Äî`;
  $("#screen-welcome").classList.add("hidden");
  $("#screen-chat").classList.remove("hidden");
  addBubble(rnd("Szia! Kezdhetj√ºk. üòä","Hell√≥! Miben seg√≠thetek?","Cs≈ë! √çrj egy √ºzenetet."));
});
</script>
</body>
</html>

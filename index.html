<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tam√°s Mesters√©ges (AI)</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü§ñ</text></svg>">
  <style>
    :root{
      --bg: #0f1317;
      --glass: rgba(18,21,26,0.6);
      --glass-strong: rgba(18,21,26,0.75);
      --text: #e9eef5;
      --muted: #a9b4c0;
      --accent: #ffa93a;
      --bubble-bot: rgba(32,37,43,0.9);
      --bubble-user: #ffb957;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
    }
    [data-theme="light"]{
      --bg: #eef2f6;
      --glass: rgba(255,255,255,.55);
      --glass-strong: rgba(255,255,255,.7);
      --text:#1a2029;
      --muted:#46515e;
      --bubble-bot: rgba(255,255,255,.9);
      --bubble-user: #ffb34f;
      --shadow: 0 10px 30px rgba(0,0,0,.12);
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;color:var(--text);background:var(--bg);font:16px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji"}
    body::before{
      content:"";
      position:fixed; inset:0;
      background: url("bg_tamas.jpg") center/cover no-repeat fixed;
      filter: blur(6px) brightness(.55);
      transform: scale(1.06);
      z-index:-2;
    }
    [data-theme="light"] body::before{ filter: blur(6px) brightness(.9); }
    .scrim{ position:fixed; inset:0; z-index:-1; background: radial-gradient(1200px 800px at 70% 15%, rgba(0,0,0,.25), transparent 60%), linear-gradient(to bottom, rgba(0,0,0,.25), transparent 40%); }
    [data-theme="light"] .scrim{ background: linear-gradient(to bottom, rgba(255,255,255,.25), transparent 40%); }

    .wrap{ min-height:100svh; display:flex; flex-direction:column; padding:16px; gap:16px; }
    header{ backdrop-filter: blur(10px); background: var(--glass); border-radius: var(--radius); box-shadow: var(--shadow); padding:18px 20px; display:flex; align-items:center; justify-content:space-between; gap:16px; }
    .brand h1{ margin:0; font-size:clamp(20px, 3.2vw, 32px); letter-spacing:.2px }
    .brand small{ display:block; color:var(--muted); margin-top:4px }
    .theme-toggle{ border:0; border-radius:14px; padding:10px 14px; cursor:pointer; background: var(--glass-strong); color:var(--text); box-shadow: var(--shadow); }

    .card{ flex:1; min-height:0; display:flex; flex-direction:column; backdrop-filter: blur(10px); background: var(--glass-strong); border-radius: calc(var(--radius) + 6px); box-shadow: var(--shadow); overflow:hidden; }
    .messages{ padding:18px 18px 6px; overflow:auto; flex:1; scroll-behavior:smooth; }
    .msg{ max-width:min(720px, 92%); margin:10px 0; padding:14px 16px; border-radius: 18px; box-shadow: 0 6px 18px rgba(0,0,0,.18); word-wrap:break-word; white-space:pre-wrap; opacity:0; }
    .msg.bot{ background: var(--bubble-bot); border-top-left-radius: 8px; }
    .msg.user{ margin-left:auto; background: var(--bubble-user); color:#2d240f; border-top-right-radius: 8px; }

    /* be√∫sz√°s anim√°ci√≥ */
    @keyframes slideFadeIn {
      from { transform: translateY(8px); opacity: 0; }
      to   { transform: translateY(0);   opacity: 1; }
    }
    .msg.appear { animation: slideFadeIn 380ms ease-out forwards; }

    /* typing indicator */
    .typing{ display:inline-flex; align-items:center; gap:8px; }
    .typing .dots{ display:inline-flex; gap:6px; }
    .typing .dot{ width:7px; height:7px; border-radius:50%; background: currentColor; opacity:.45; animation: blink 1.1s infinite; }
    .typing .dot:nth-child(2){ animation-delay:.2s }
    .typing .dot:nth-child(3){ animation-delay:.4s }
    @keyframes blink{ 0%,80%,100%{opacity:.25} 40%{opacity:1} }

    .composer{ display:flex; align-items:center; gap:12px; padding:12px; border-top: 1px solid rgba(255,255,255,.06); }
    .input{ flex:1; display:flex; align-items:center; gap:10px; background: var(--glass); border:1px solid rgba(255,255,255,.08); border-radius: 16px; padding:8px 10px 8px 14px; }
    textarea{ flex:1; resize:none; border:0; outline:0; background:transparent; color:var(--text); max-height:120px; font-size:16px; }
    .icon-btn{ min-width:44px; height:44px; border-radius:14px; border:0; cursor:pointer; background: var(--glass); color: var(--text); display:inline-flex; align-items:center; justify-content:center; transition:.15s transform ease; }
    .icon-btn:active{ transform: translateY(1px) scale(.98) }
    .send{ background: var(--accent); color:#1b1403; padding:0 20px; font-weight:600 }

    footer{ text-align:center; color:var(--muted); font-size:13px; padding:6px 8px 2px; text-shadow: 0 1px 1px rgba(0,0,0,.25); }
    @media (max-width: 600px){ .composer{ padding-bottom: max(12px, env(safe-area-inset-bottom)) } }
  </style>
</head>
<body>
  <div class="scrim"></div>
  <div class="wrap">
    <header>
      <div class="brand">
        <h1>Tam√°s Mesters√©ges (AI)</h1>
        <small>Halad√≥ fejleszt√©s ‚Äî bar√°ts√°gos magyar asszisztens</small>
      </div>
      <button class="theme-toggle" id="themeBtn">Light / Dark</button>
    </header>

    <section class="card">
      <div id="msgs" class="messages"></div>
      <div class="composer">
        <div class="input">
          <textarea id="text" rows="1" placeholder="√çrj ide‚Ä¶  Enter = k√ºld√©s"></textarea>
          <button id="speakBtn" class="icon-btn" aria-label="Felolvas√°s">üîà</button>
        </div>
        <button id="sendBtn" class="icon-btn send">K√ºld√©s</button>
      </div>
    </section>

    <footer>¬© Tam√°s AI ‚Äî v√©dett oldal. B√°rmilyen m√°sol√°s jogs√©rt√©snek min≈ës√ºl.</footer>
  </div>

  <script>
    const msgs = document.getElementById('msgs');
    const ta = document.getElementById('text');
    const send = document.getElementById('sendBtn');
    const speakBtn = document.getElementById('speakBtn');
    const themeBtn = document.getElementById('themeBtn');
    let ttsOn = false;

    function addMsg(text, who='bot'){
      const el = document.createElement('div');
      el.className = `msg ${who}`;
      el.textContent = text;
      msgs.appendChild(el);
      // kis k√©sleltet√©s, hogy az anim√°ci√≥ induljon
      requestAnimationFrame(()=> el.classList.add('appear'));
      msgs.scrollTop = msgs.scrollHeight;
      if(who==='bot' && ttsOn){ speak(text); }
      return el;
    }

    function showTyping(){
      const el = document.createElement('div');
      el.className = 'msg bot typing';
      el.innerHTML = 'Gondolkodom <span class="dots"><span class="dot"></span><span class="dot"></span><span class="dot"></span></span>';
      msgs.appendChild(el);
      msgs.scrollTop = msgs.scrollHeight;
      return el;
    }

    function speak(text){
      try{
        speechSynthesis.cancel();
        const u = new SpeechSynthesisUtterance(text);
        u.lang='hu-HU';
        speechSynthesis.speak(u);
      }catch(e){}
    }

    async function sendMessage(){
      const text = ta.value.trim();
      if(!text) return;
      addMsg(text,'user');
      ta.value='';
      const typing = showTyping();
      try{
        const r=await fetch('/.netlify/functions/chat',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({message:text})});
        typing.remove();
        const data=await r.json();
        const reply=data.reply || "√ârtem. Miben seg√≠thetek m√©g?";
        addMsg(reply,'bot');
      }catch(e){
        typing.remove();
        addMsg("Hiba t√∂rt√©nt: "+e.message,'bot');
      }
    }

    send.addEventListener('click', sendMessage);
    ta.addEventListener('keydown', e=>{ if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendMessage();}});
    speakBtn.addEventListener('click', ()=>{ttsOn=!ttsOn; speakBtn.textContent=ttsOn?'üîä':'üîà';});
    themeBtn.addEventListener('click', ()=>{ const cur=document.documentElement.getAttribute('data-theme')==='light'; document.documentElement.setAttribute('data-theme', cur?'dark':'light'); });

    // indul√≥ √ºzenet
    addMsg("Szia! Itt vagyok neked, seg√≠tek mindenben. √çrj b√°tran! üòä",'bot');
  </script>
</body>
</html>

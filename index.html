<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tam√°s Mesters√©ges (AI) ‚Äî Chat</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ü§ñ</text></svg>">
  <style>
    :root{
      --bg:#0e0f12;
      --glass:#1a1d24cc;
      --glass-strong:#1a1d24f2;
      --text:#e8ebf1;
      --muted:#9aa3b2;
      --brand:#f4a62a;
      --me:#2e7dd7;
      --bot:#3a3f4a;
      --ring:#2b303a;
      --shadow: 0 12px 40px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.03);
      --radius:18px;
      --radius-sm:12px;
      --max: 1100px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background: radial-gradient(1200px 800px at 10% -10%, #1c2028 0, transparent 60%),
                         radial-gradient(1000px 700px at 100% 0, #13161c 0, transparent 65%),
                         var(--bg);
      color:var(--text); font: 16px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
      display:flex; align-items:center; justify-content:center;
    }
    .wrap{ width:100%; max-width:var(--max); padding:16px; }
    header{
      display:flex; align-items:center; gap:14px; margin-bottom:14px;
    }
    .badge{
      background:linear-gradient(180deg,#212632,#161a22); color:var(--text);
      border:1px solid #2b3140; padding:10px 14px; border-radius:var(--radius);
      box-shadow:var(--shadow);
    }
    .brand{ font-weight:700; font-size:20px; letter-spacing:.2px }
    .sub{ color:var(--muted); font-size:14px }

    .chat{
      background:var(--glass); border:1px solid var(--ring);
      border-radius:var(--radius); box-shadow:var(--shadow);
      display:flex; flex-direction:column; height: min(78vh, 820px);
      position:relative; overflow:hidden;
    }
    .msgs{ padding:18px; overflow:auto; flex:1; scroll-behavior:smooth }
    .msg{ max-width: 85%; padding:12px 14px; border-radius:var(--radius);
          margin:8px 0; word-wrap:break-word; white-space:pre-wrap }
    .msg.user{ background:linear-gradient(180deg,#2a74cf,#245da5); align-self:flex-end }
    .msg.bot{ background:linear-gradient(180deg,#2a2f39,#222530); border:1px solid #333846 }
    .msg.info{ background:#1f232c; color:var(--muted); border:1px dashed #3a4150 }
    .row{
      display:flex; gap:10px; align-items:center;
      padding:12px; border-top:1px solid var(--ring); background:var(--glass-strong)
    }
    .input{
      flex:1; background:#14171d; border:1px solid #2c3240; color:var(--text);
      outline:none; border-radius:14px; padding:12px 14px; min-height:44px;
    }
    .btn{
      background:linear-gradient(180deg,#f6b24a,#f19b12); color:#1a1205;
      border:none; padding:12px 16px; border-radius:14px; font-weight:700; cursor:pointer;
      box-shadow: 0 6px 20px rgba(244,166,42,.35);
    }
    .btn:disabled{ opacity:.6; cursor:not-allowed }
    .pill{
      position:absolute; right:12px; bottom:12px;
      display:flex; align-items:center; gap:10px;
      background:#151821cc; border:1px solid #2b3140;
      padding:8px 10px; border-radius:999px; box-shadow:var(--shadow);
      user-select:none
    }
    .icon-btn{
      background:#0f1217; border:1px solid #2b3140; color:var(--text);
      width:36px; height:36px; border-radius:999px; display:grid; place-items:center; cursor:pointer
    }
    .hint{ color:var(--muted); font-size:12px; margin-left:8px }
    footer{ margin-top:10px; color:var(--muted); font-size:12px; text-align:center }
    @media (max-width: 680px){
      .msg{ max-width: 92% }
      .brand{ font-size:18px }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="badge">
        <div class="brand">Tam√°s Mesters√©ges (AI)</div>
        <div class="sub">Hobbi fejleszt√©s ‚Äî bar√°ts√°gos magyar asszisztens</div>
      </div>
    </header>

    <section class="chat" id="chat">
      <div class="msgs" id="msgs"></div>

      <div class="row">
        <input id="text" class="input" placeholder="√çrj ide‚Ä¶  Enter = k√ºld√©s, Shift+Enter = √∫j sor" />
        <button id="send" class="btn">K√ºld√©s</button>
      </div>

      <!-- hang kapcsol√≥ a jobb als√≥ sarokban -->
      <div class="pill">
        <button id="ttsBtn" class="icon-btn" title="Felolvas√°s ki/be">üîà</button>
        <span class="hint" id="ttsHint">Felolvas√°s: kikapcsolva</span>
      </div>
    </section>

    <footer>¬© Tam√°s AI ‚Äî v√©dett oldal. B√°rmilyen m√°sol√°s jogs√©rt√©snek min≈ës√ºl.</footer>
  </div>

<script>
  // ===== UI elemek
  const msgs = document.getElementById('msgs');
  const text = document.getElementById('text');
  const send = document.getElementById('send');
  const ttsBtn = document.getElementById('ttsBtn');
  const ttsHint = document.getElementById('ttsHint');

  // ===== √°llapot
  let ttsOn = false;

  // ===== seg√©dek
  function addMsg(t, who='bot', extraClass=''){
    const b = document.createElement('div');
    b.className = `msg ${who} ${extraClass}`.trim();
    b.textContent = t;
    msgs.appendChild(b);
    msgs.scrollTop = msgs.scrollHeight;
    return b;
    }
  function addInfo(t){ return addMsg(t,'bot','info'); }

  function speakHu(text){
    try{
      const u = new SpeechSynthesisUtterance(text);
      u.lang = 'hu-HU';
      u.rate = 1.0;
      speechSynthesis.cancel();
      speechSynthesis.speak(u);
    }catch(_){}
  }

  function setTTS(on){
    ttsOn = on;
    ttsBtn.textContent = on ? 'üîä' : 'üîà';
    ttsHint.textContent = 'Felolvas√°s: ' + (on ? 'bekapcsolva' : 'kikapcsolva');
    if(!on){ try{ speechSynthesis.cancel(); }catch(_){ } }
  }

  // ===== backend h√≠v√°s
  async function ask(textIn){
    // saj√°t √ºzenet
    addMsg(textIn, 'user');

    const thinking = addInfo('‚Ä¶');
    try{
      const r = await fetch('/.netlify/functions/chat', {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ message: textIn })
      });
      if(!r.ok) throw new Error('HTTP '+r.status);
      const data = await r.json();
      const reply = String(data.reply ?? '√ârtem. Miben seg√≠thetek m√©g?');

      thinking.remove();
      addMsg(reply, 'bot');
      if(ttsOn) speakHu(reply);
    }catch(e){
      thinking.remove();
      addMsg('Hiba: '+(e.message || e), 'bot', 'info');
    }
  }

  // ===== esem√©nyek
  send.addEventListener('click', ()=>{
    const v = text.value.trim();
    if(!v) return;
    text.value = '';
    ask(v);
  });
  text.addEventListener('keydown', (e)=>{
    if(e.key === 'Enter' && !e.shiftKey){
      e.preventDefault();
      send.click();
    }
  });
  ttsBtn.addEventListener('click', ()=> setTTS(!ttsOn));

  // ===== √ºdv√∂zl√©s (csak 1 sor, NINCS d√°tum)
  addMsg('Szia! Itt vagyok neked, seg√≠tek mindenben. √çrj b√°tran! üôÇ', 'bot');
  setTTS(false); // alapb√≥l kikapcsolva
</script>
</body>
</html>

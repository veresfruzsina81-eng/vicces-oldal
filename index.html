<!doctype html>
<html lang="hu">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Tam√°s Mesters√©ges (AI)</title>
<link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='46' fill='%23f6a300'/%3E%3Ctext x='50' y='60' font-size='48' text-anchor='middle' fill='%230b1016' font-family='system-ui,sans-serif'%3ET%3C/text%3E%3C/svg%3E" />
<style>
  :root{
    --bg-dim: 0.22;              /* h√°tt√©r halv√°ny√≠t√°s */
    --blur: 12px;                /* √ºveghat√°s er≈ëss√©ge */
    --panel-alpha: .38;          /* √ºveglap √°tl√°tsz√≥s√°g */
    --bubble-alpha: .46;         /* bot bubor√©k √°tl√°tsz√≥s√°g */
    --radius: 20px;
    --maxw: 1000px;
    --gap: 14px;
    --txt: #e9eef6;
    --muted: #adbac9;
    --brand1: #ffb22a;           /* felhaszn√°l√≥ bubor√©k */
    --brand2: #ff9a1f;
    --chip-bg: rgba(255,255,255,.1);
    --chip-brd: rgba(255,255,255,.18);
    color-scheme: dark;
  }
  [data-theme="light"]{
    --bg-dim: 0.08;
    --txt: #0b1016;
    --muted: #38424f;
    --chip-bg: rgba(0,0,0,.05);
    --chip-brd: rgba(0,0,0,.12);
    color-scheme: light;
  }

  *{ box-sizing: border-box; }
  html,body{ height:100%; }
  body{
    margin:0;
    font-family: system-ui, Segoe UI, Roboto, Arial, sans-serif;
    color: var(--txt);
    background: #0b1016;
    overflow-y: overlay;
  }

  /* H√°tt√©rk√©p + enyhe s√∂t√©t√≠t√©s */
  body::before{
    content:"";
    position:fixed; inset:0;
    background: url("bg_tamas.jpg") center / cover no-repeat;
    z-index:-2;
  }
  body::after{
    content:"";
    position:fixed; inset:0;
    background: rgba(0,0,0,var(--bg-dim));
    z-index:-1;
  }

  .wrap{
    width:min(var(--maxw), 96vw);
    margin:0 auto;
    padding:10px 0 24px;
  }

  /* Fejl√©c ‚Äì nem l√≥g r√° a chatre */
  header{
    position: sticky; top:10px; z-index:50;
    display:flex; align-items:center; justify-content:space-between;
    gap:10px;
    padding:14px 18px;
    margin-bottom: 8px;
    background: rgba(20,24,30,var(--panel-alpha));
    backdrop-filter: blur(var(--blur)) saturate(120%);
    border:1px solid rgba(255,255,255,.12);
    border-radius: 28px;
    box-shadow: 0 10px 30px rgba(0,0,0,.28);
  }
  header h1{
    margin:0;
    font-size:clamp(20px, 3.4vw, 36px);
    line-height:1.1;
  }
  header p{
    margin:4px 0 0;
    color:var(--muted);
    font-size:clamp(12px, 1.7vw, 16px);
  }
  .mode{
    white-space:nowrap;
    padding:10px 14px;
    border-radius: 14px;
    border:1px solid rgba(255,255,255,.15);
    background: rgba(0,0,0,.18);
    cursor:pointer;
    user-select:none;
  }

  /* Chat panel */
  .panel{
    margin-top: 6px;
    background: rgba(20,24,30,var(--panel-alpha));
    border:1px solid rgba(255,255,255,.10);
    backdrop-filter: blur(var(--blur)) saturate(120%);
    border-radius: 26px;
    padding: 16px;
    box-shadow: 0 14px 40px rgba(0,0,0,.28);
    min-height: 56vh;
    display:flex; flex-direction:column;
    gap: var(--gap);
    /* hogy a sticky composer ne takarjon ki semmit: */
    padding-bottom: 160px;
  }

  /* Aj√°nlott k√©rd√©sek ‚Äì v√≠zszintes g√∂rget√©s mobilon */
  .sugs{
    display:flex; gap:10px; overflow:auto; padding:6px 2px;
    scroll-snap-type:x mandatory;
  }
  .sugs button{
    scroll-snap-align:start;
    flex:0 0 auto;
    padding:10px 14px;
    border-radius:999px;
    border:1px solid var(--chip-brd);
    background: var(--chip-bg);
    color:var(--txt);
    backdrop-filter: blur(6px);
    cursor:pointer;
  }

  /* √úzenetek */
  .msg{
    max-width: min(720px, 92%);
    word-wrap: break-word;
    line-height:1.45;
    border-radius: 22px;
    padding:16px 18px;
    box-shadow: 0 10px 28px rgba(0,0,0,.22);
  }
  .msg.user{
    margin-left:auto;
    background: linear-gradient(180deg, var(--brand1), var(--brand2));
    color:#1a1203;
    font-weight:600;
  }
  .msg.bot{
    margin-right:auto;
    background: rgba(12,16,22,var(--bubble-alpha));
    border:1px solid rgba(255,255,255,.10);
    backdrop-filter: blur(10px) saturate(120%);
  }

  /* Gombsor az AI v√°lasz alatt */
  .tools{
    display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;
  }
  .chip{
    display:inline-flex; align-items:center; gap:8px;
    padding:8px 12px; border-radius: 14px;
    border:1px solid var(--chip-brd); background: var(--chip-bg);
    cursor:pointer; user-select:none;
  }
  .chip svg{ width:18px; height:18px; opacity:.9; }

  /* Als√≥ composer ‚Äì sticky */
  .composer{
    position: sticky; bottom: 10px; z-index:40;
    margin-top:auto;
    display:flex; gap:12px; align-items:center;
    background: rgba(20,24,30,.42);
    border:1px solid rgba(255,255,255,.12);
    backdrop-filter: blur(10px);
    border-radius: 20px;
    padding:10px;
  }
  .composer input{
    flex:1; border:0; outline:0;
    font: inherit; font-size:16px;
    padding:14px 16px; border-radius:14px;
    color:var(--txt);
    background: rgba(255,255,255,.08);
  }
  .composer button{
    border:0; padding:14px 20px; border-radius:14px;
    background: linear-gradient(180deg, var(--brand1), var(--brand2));
    color:#1a1203; font-weight:700; cursor:pointer;
    box-shadow: 0 8px 20px rgba(0,0,0,.24);
  }

  footer{
    width:min(var(--maxw), 96vw);
    margin:12px auto 22px;
    color: var(--muted);
    font-size:12px;
    text-align:center;
    text-shadow: 0 1px 2px rgba(0,0,0,.35);
  }

  @media (max-width:480px){
    .msg{ border-radius:20px; padding:14px 16px; }
    .chip{ padding:7px 10px; }
    .composer{ gap:8px; }
    .composer button{ padding:13px 16px; }
  }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Tam√°s Mesters√©ges (AI)</h1>
        <p>Halad√≥ fejleszt√©s ‚Äî bar√°ts√°gos magyar asszisztens</p>
      </div>
      <button id="themeToggle" class="mode" type="button">Light / Dark<br><small>(auto)</small></button>
    </header>

    <main class="panel" id="panel">
      <!-- Kezd≈ë √ºzenet -->
      <div class="msg bot">
        Szia! Itt vagyok neked, seg√≠tek mindenben. √çrj b√°tran! üòä
        <div class="tools">
          <button class="chip" data-action="speak">
            <!-- hang ikon -->
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 10v4h3l4 4V6L6 10H3zm13.5 2c0-1.77-1.02-3.29-2.5-4.03v8.06A4.49 4.49 0 0016.5 12zM14 3.23v2.06a7 7 0 010 13.42v2.06c3.99-0.73 7-4.24 7-8.48s-3.01-7.75-7-8.06z"/></svg>
            Felolvas√°s
          </button>
          <button class="chip" data-action="copy">
            <!-- m√°sol√°s ikon -->
            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H4c-1.1 0-2 .9-2 2v12h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
            M√°sol√°s
          </button>
        </div>
      </div>

      <!-- Aj√°nlott k√©rd√©sek ‚Äì v√≠zszintesen g√∂rgethet≈ë -->
      <div class="sugs" id="sugs">
        <button>Mes√©lj Horv√°th Tam√°sr√≥l r√∂viden!</button>
        <button>Milyen modell vagy?</button>
        <button>Mi a mai d√°tum?</button>
        <button>Mit tudsz csin√°lni?</button>
      </div>

      <!-- √úzenetlista (ide ker√ºlnek az √∫j elemek) -->
      <div id="list"></div>

      <!-- Als√≥ composer -->
      <form class="composer" id="composer">
        <input id="input" placeholder="√çrj ide‚Ä¶   Enter = k√ºld√©s" autocomplete="off" />
        <button id="send" type="submit">K√ºld√©s</button>
      </form>
    </main>

    <footer>
      ¬© Tam√°s AI ‚Äî v√©dett oldal. B√°rmilyen m√°sol√°s jogs√©rt√©snek min≈ës√ºl.
    </footer>
  </div>

<script>
(function(){
  const panel = document.getElementById('panel');
  const list  = document.getElementById('list');
  const form  = document.getElementById('composer');
  const input = document.getElementById('input');
  const themeBtn = document.getElementById('themeToggle');

  // T√©ma v√°lt√°s (auto / light / dark)
  const saved = localStorage.getItem('theme');
  if(saved){ document.documentElement.setAttribute('data-theme', saved); themeBtn.innerHTML = labelFor(saved); }
  themeBtn.addEventListener('click', ()=>{
    const cur = document.documentElement.getAttribute('data-theme') || 'auto';
    const next = cur === 'auto' ? 'light' : cur === 'light' ? 'dark' : 'auto';
    if(next === 'auto'){ document.documentElement.removeAttribute('data-theme'); localStorage.removeItem('theme'); }
    else{ document.documentElement.setAttribute('data-theme', next); localStorage.setItem('theme', next); }
    themeBtn.innerHTML = labelFor(next);
  });
  function labelFor(t){ return (t==='light'||t==='dark') ? `${t[0].toUpperCase()+t.slice(1)} / ${t==='light'?'Dark':'Light'}` : 'Light / Dark<br><small>(auto)</small>'; }

  // Aj√°nlott k√©rd√©sek kattint√°s
  document.getElementById('sugs').addEventListener('click', e=>{
    if(e.target.tagName === 'BUTTON'){ input.value = e.target.textContent.trim(); input.focus(); }
  });

  // √úzenet l√©trehoz√°sa
  function bubble(text, who='bot'){
    const div = document.createElement('div');
    div.className = `msg ${who}`;
    div.textContent = text;
    // bot eszk√∂z√∂k
    if(who==='bot'){
      const tools = document.createElement('div');
      tools.className = 'tools';
      tools.innerHTML = `
        <button class="chip" data-action="speak">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M3 10v4h3l4 4V6L6 10H3zm13.5 2c0-1.77-1.02-3.29-2.5-4.03v8.06A4.49 4.49 0 0016.5 12zM14 3.23v2.06a7 7 0 010 13.42v2.06c3.99-0.73 7-4.24 7-8.48s-3.01-7.75-7-8.06z"/></svg>
          Felolvas√°s
        </button>
        <button class="chip" data-action="copy">
          <svg viewBox="0 0 24 24" fill="currentColor"><path d="M16 1H4c-1.1 0-2 .9-2 2v12h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
          M√°sol√°s
        </button>`;
      div.appendChild(tools);
    }
    list.appendChild(div);
    // automata scroll, de finoman
    setTimeout(()=>div.scrollIntoView({behavior:'smooth', block:'end'}), 10);
    return div;
  }

  // Felolvas√°s & M√°sol√°s (delegation)
  panel.addEventListener('click', e=>{
    const chip = e.target.closest('.chip'); if(!chip) return;
    const msg = e.target.closest('.msg'); if(!msg) return;
    const action = chip.dataset.action;
    if(action==='copy'){
      navigator.clipboard.writeText(msg.firstChild.textContent || msg.textContent);
      chip.style.transform='scale(0.98)'; setTimeout(()=>chip.style.transform='',120);
    }else if(action==='speak'){
      const utter = new SpeechSynthesisUtterance(msg.firstChild.textContent || msg.textContent);
      utter.lang = 'hu-HU';
      speechSynthesis.cancel(); speechSynthesis.speak(utter);
    }
  });

  // K√ºld√©s
  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    const text = input.value.trim();
    if(!text) return;
    bubble(text,'user');
    input.value = '';

    const thinking = bubble('Gondolkodom‚Ä¶ ü§î','bot');

    try{
      const r = await fetch('/.netlify/functions/chat', {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({ message: text })
      });
      const data = await r.json();
      thinking.firstChild.textContent = (data && data.reply) ? data.reply : 'Bocsi, most √©pp nem √©rem el a szervert. √çrj m√°sk√©nt: mit szeretn√©l pontosan? üòä';
    }catch(err){
      thinking.firstChild.textContent = 'Hopp, hiba t√∂rt√©nt a kapcsolatban. Pr√≥b√°ld meg √∫jra picit k√©s≈ëbb! üôè';
    }
  });
})();
</script>
</body>
</html>

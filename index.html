<!doctype html>
<html lang="hu">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Vicck√∂zpont v10 ‚Äì stabil + kv√≠z-h√°tt√©r</title>
<style>
  :root{
    --bg:#0a0f1f; --glass:rgba(255,255,255,.06); --line:rgba(255,255,255,.16);
    --text:#e6ecff; --muted:#a7b1d6;
    --ok:#22c55e; --info:#60a5fa; --warn:#f59e0b; --danger:#ef4444;
    --goodGrad:linear-gradient(90deg,#22c55e,#16a34a);
    --infoGrad:linear-gradient(90deg,#60a5fa,#3b82f6);
    --warnGrad:linear-gradient(90deg,#f59e0b,#fbbf24);
    --badGrad:linear-gradient(90deg,#ef4444,#dc2626);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0}
  body{color:var(--text); background:var(--bg); font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif; overflow-x:hidden}

  /* H√°tt√©r v√°sznak (WAVE) */
  #bgCanvas{position:fixed; inset:0; z-index:0;
    background:
      radial-gradient(1200px 800px at 120% -20%,#22d3ee15 0 40%,transparent 60%),
      radial-gradient(1000px 700px at -20% 120%,#7c3aed15 0 40%,transparent 60%),
      #0a0f1f;
  }
  #fxCanvas{position:fixed; inset:0; z-index:2; pointer-events:none}

  /* Appbar */
  header.appbar{position:sticky; top:0; z-index:3; display:flex; align-items:center; gap:12px; padding:12px 16px;
    background:linear-gradient(180deg, rgba(15,22,44,.85), rgba(15,22,44,.55)); backdrop-filter:blur(10px); border-bottom:1px solid var(--line)}
  .logo{display:flex; align-items:center; gap:10px; font-weight:900}
  .logo .dot{width:12px;height:12px;border-radius:50%;background:linear-gradient(90deg,#7c3aed,#22d3ee);box-shadow:0 0 18px #22d3ee90}
  nav.tabs{margin-left:auto; display:flex; gap:6px; flex-wrap:wrap}
  .tab{padding:8px 12px; border:1px solid var(--line); border-radius:999px; background:var(--glass); color:var(--text); cursor:pointer; font-weight:700}
  .tab.active{background:linear-gradient(90deg,#7c3aed,#22d3ee); color:#061225; border-color:transparent}

  main{max-width:1200px; margin:20px auto; padding:0 16px; position:relative; z-index:1;}

  /* Auth */
  .auth{max-width:480px; margin:50px auto; padding:24px; border-radius:16px;
    background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
    border:1px solid var(--line); backdrop-filter:blur(10px); box-shadow:0 30px 80px rgba(0,0,0,.35)}
  .auth h1{margin:0 0 6px}
  .muted{color:var(--muted)}
  label{display:block; font-weight:800; margin:14px 0 6px}
  input{
    width:100%; padding:12px 14px; border-radius:12px; border:1px solid var(--line);
    background:rgba(255,255,255,.06); color:var(--text); outline:none; font-size:15px}
  .btn{display:inline-flex; align-items:center; justify-content:center; gap:8px; padding:12px 16px; border:0; border-radius:12px;
    font-weight:900; cursor:pointer; background:var(--goodGrad); color:#062215; box-shadow:0 10px 30px rgba(34,197,94,.25); margin-top:16px; width:100%}
  .err{color:#fecaca; font-weight:800; min-height:18px; margin-top:10px}

  /* Views */
  section.view{display:none; animation:fade .35s ease both}
  section.view.active{display:block}
  @keyframes fade{from{opacity:0; transform:translateY(6px)} to{opacity:1; transform:none}}

  /* Grid + Cards */
  .grid{display:grid; grid-template-columns:repeat(12,1fr); gap:16px}
  @media (max-width:980px){ .grid{grid-template-columns:repeat(8,1fr)} }
  @media (max-width:640px){ .grid{grid-template-columns:repeat(4,1fr)} }
  .card{background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.05));
    border:1px solid var(--line); border-radius:16px; padding:16px; backdrop-filter:blur(10px); box-shadow:0 16px 50px rgba(0,0,0,.3)}
  .title{font-weight:900; margin:0 0 8px}
  .box{border:1px solid var(--line); border-radius:12px; background:rgba(10,12,22,.6); padding:12px; min-height:36px}
  .row{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
  .chip{padding:8px 12px; border-radius:999px; border:1px solid var(--line); background:var(--glass); cursor:pointer; font-weight:800}
  .chip.ok{background:var(--goodGrad); color:#062215; border-color:transparent}
  .chip.info{background:var(--infoGrad); color:#071321; border-color:transparent}
  .chip.warn{background:var(--warnGrad); color:#2b1a03; border-color:transparent}
  .chip.danger{background:var(--badGrad); color:#2b0a0a; border-color:transparent}
  .span-8{grid-column:span 8} .span-6{grid-column:span 6} .span-4{grid-column:span 4}
  @media (max-width:980px){ .span-8,.span-6,.span-4{grid-column:span 8} }
  @media (max-width:640px){ .span-8,.span-6,.span-4{grid-column:span 4} }

  /* Kv√≠z UI */
  .quizHud{display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin-bottom:10px}
  .badge{padding:6px 10px; background:#1f2b4d; border:1px solid var(--line); border-radius:999px}
  .meter{flex:1; height:10px; background:#203056; border:1px solid var(--line); border-radius:999px; overflow:hidden}
  .meter>span{display:block; height:100%; width:100%; background:var(--badGrad); transform-origin:left; transform:scaleX(1); transition:transform .2s linear}
  .answers{display:grid; grid-template-columns:repeat(2,1fr); gap:10px; margin-top:10px}
  .ans{padding:12px; border-radius:12px; border:1px solid var(--line); background:rgba(14,18,30,.75); cursor:pointer; font-weight:800}
  .ans.correct{outline:2px solid #22c55eaa}
  .ans.wrong{outline:2px solid #ef4444aa}
  .table{width:100%; border-collapse:collapse; margin-top:10px}
  .table th,.table td{border-bottom:1px solid var(--line); padding:8px; text-align:left}
  .table th{opacity:.8; font-weight:800}

  /* Loading overlay */
  #loading{position:fixed; inset:0; display:none; place-items:center; z-index:4;
    background:rgba(8,12,30,.6); backdrop-filter:blur(6px)}
  .loader{width:min(360px,92vw); padding:18px; border-radius:14px;
    background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
    border:1px solid var(--line); text-align:center; box-shadow:0 20px 60px rgba(0,0,0,.45)}

  /* Am≈ëba */
  .ttt-grid{display:grid; grid-template-columns:repeat(3,100px); grid-template-rows:repeat(3,100px); gap:8px; justify-content:center}
  .ttt-cell{display:grid; place-items:center; font-size:36px; font-weight:900; border-radius:12px; background:rgba(255,255,255,.07); border:1px solid var(--line); cursor:pointer; user-select:none}
  .ttt-cell.win{background:linear-gradient(180deg, rgba(34,197,94,.25), rgba(34,197,94,.15))}
  .ttt-panel{display:flex; gap:10px; align-items:center; justify-content:center; flex-wrap:wrap; margin-top:10px}

  /* Chat */
  .chat-wrap{max-width:900px; margin:0 auto}
  .chat-box{height:380px; border:1px solid var(--line); background:rgba(10,12,22,.55); border-radius:14px; padding:12px; overflow:auto; scroll-behavior:smooth}
  .msg{max-width:70%; padding:10px 12px; border-radius:12px; margin:8px 0; line-height:1.3; word-wrap:break-word}
  .user{margin-left:auto; background:linear-gradient(180deg, rgba(96,165,250,.25), rgba(96,165,250,.15)); border:1px solid #60a5fa55}
  .bot{margin-right:auto; background:linear-gradient(180deg, rgba(124,58,237,.25), rgba(124,58,237,.15)); border:1px solid #7c3aed55}
  .chat-input{display:flex; gap:8px; margin-top:10px}
  .chat-input input{flex:1}
  .chat-tip{font-size:12px; color:#c9d1ff99; margin-top:6px}

  /* K√ºl√∂n kv√≠z-t√©ma a H√ÅTT√âRHEZ (csak a kv√≠z n√©zetben aktiv) */
  body.quiz-theme #bgCanvas{
    background:
      radial-gradient(900px 600px at 110% -10%, #22d3ee22 0 40%, transparent 60%),
      radial-gradient(800px 500px at -10% 110%, #7c3aed22 0 40%, transparent 60%),
      repeating-conic-gradient(from 0deg,
        #ffd166 0 14deg, #ef476f 14deg 28deg, #06d6a0 28deg 42deg, #118ab2 42deg 56deg);
    filter:saturate(1.2);
  }
  body.quiz-theme #quizCard{
    background:rgba(6,10,20,.78);
    border:1px solid rgba(255,255,255,.18);
    box-shadow:0 30px 80px rgba(0,0,0,.55);
  }
</style>
</head>
<body>
<canvas id="bgCanvas"></canvas>
<canvas id="fxCanvas"></canvas>

<header class="appbar" id="appbar" style="display:none">
  <div class="logo"><span class="dot"></span> Vicck√∂zpont <small style="opacity:.7;font-weight:600;margin-left:6px">v10</small></div>
  <nav class="tabs" id="tabs">
    <button class="tab active" data-view="home">F≈ëoldal</button>
    <button class="tab" data-view="sounds">Hangok</button>
    <button class="tab" data-view="games">J√°t√©kok</button>
    <button class="tab" data-view="weather">Id≈ëj√°r√°s</button>
    <button class="tab" data-view="quizpro">Kv√≠z Bajnoks√°g</button>
    <button class="tab" data-view="tictactoe">Am≈ëba</button>
    <button class="tab" data-view="chat">Chat</button>
  </nav>
</header>

<!-- Loading overlay -->
<div id="loading"><div class="loader"><div id="loadingText">K√°v√©szemek ≈ërl√©se‚Ä¶</div></div></div>

<main id="app">
  <!-- LOGIN -->
  <section id="loginView" class="auth">
    <h1>Bejelentkez√©s</h1>
    <p class="muted">Humor, hangok √©s mini-j√°t√©kok ‚Äì modern kiad√°sban. üîäüéÆ</p>
    <form id="form" novalidate>
      <label for="name">N√©v</label>
      <input id="name" type="text" required placeholder="N√©v">
      <label for="email">Email</label>
      <input id="email" type="email" required placeholder="valami@email.hu">
      <label for="pwd">Jelsz√≥</label>
      <input id="pwd" type="password" minlength="4" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
      <button class="btn" type="submit">Bel√©pek</button>
      <div id="err" class="err"></div>
    </form>
  </section>

  <!-- F≈ëoldal -->
  <section id="home" class="view active">
    <div class="grid">
      <div class="card span-8">
        <h3 class="title">Po√©n gener√°tor</h3>
        <div id="jokeBox" class="box">Nyomd meg valamelyik gombot! üòÑ</div>
        <div class="row" style="margin-top:10px">
          <button id="btnJoke" class="chip ok">M√©g egy po√©n</button>
          <button id="btnThree" class="chip info">3 gyors po√©n</button>
        </div>
      </div>
      <div class="card span-4">
        <h3 class="title">Gyors hang</h3>
        <div class="row">
          <button class="chip ok" data-sound="prank">Prank ‚ñ∂Ô∏è</button>
          <button class="chip info" data-sound="talent">Tehets√©ges ‚ñ∂Ô∏è</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Hangok -->
  <section id="sounds" class="view">
    <div class="grid">
      <div class="card span-6">
        <h3 class="title">Hang panel</h3>
        <p class="muted">V√°lassz hangot ‚Äì ind√≠t√°skor a m√°sik le√°ll.</p>
        <div class="row">
          <button class="chip ok" data-sound="prank">Prank ‚ñ∂Ô∏è</button>
          <button class="chip info" data-sound="talent">Tehets√©ges ‚ñ∂Ô∏è</button>
          <button class="chip warn" id="stopAll">Le√°ll√≠t</button>
        </div>
      </div>
      <div class="card span-6">
        <h3 class="title">Lej√°tsz√°s vez√©rl√©s</h3>
        <div class="row">
          <button class="chip" id="rewind">‚è™ Vissza</button>
          <button class="chip" id="pause">‚è∏Ô∏è Sz√ºnet</button>
          <button class="chip" id="resume">‚ñ∂Ô∏è Folytat</button>
        </div>
        <div id="nowPlaying" class="box" style="margin-top:10px">Semmi sem sz√≥l.</div>
      </div>
    </div>
  </section>

  <!-- J√°t√©kok -->
  <section id="games" class="view">
    <div class="grid">
      <!-- K≈ë-Pap√≠r-Oll√≥ -->
      <div class="card span-6">
        <h3 class="title">K≈ë‚ÄìPap√≠r‚ÄìOll√≥</h3>
        <div class="row" style="margin-top:8px; flex-wrap:nowrap">
          <button class="chip ok pick" data-pick="K≈ë">ü™® K≈ë</button>
          <button class="chip info pick" data-pick="Pap√≠r">üìÑ Pap√≠r</button>
          <button class="chip danger pick" data-pick="Oll√≥">‚úÇÔ∏è Oll√≥</button>
          <button id="rpsReset" class="chip warn">Reset</button>
        </div>
        <div class="row score" style="margin-top:8px">
          <span class="badge">Te: <b id="youScore">0</b></span>
          <span class="badge">G√©p: <b id="cpuScore">0</b></span>
        </div>
        <div id="rpsOut" class="box" style="margin-top:10px">V√°lassz egyet!</div>
      </div>

      <!-- Sz√°mkital√°l√≥ -->
      <div class="card span-6">
        <h3 class="title">Sz√°mkital√°l√≥</h3>
        <div class="row" style="margin-top:8px">
          <input id="guessIn" type="number" min="1" max="10" placeholder="1‚Äì10" style="width:120px">
          <button id="guessBtn" class="chip ok">Tipp!</button>
          <button id="guessNew" class="chip info">√öj sz√°m</button>
        </div>
        <div id="guessOut" class="box" style="margin-top:10px">Tippelj 1 √©s 10 k√∂z√∂tt!</div>
      </div>
    </div>
  </section>

  <!-- Id≈ëj√°r√°s -->
  <section id="weather" class="view">
    <div class="grid">
      <div class="card span-6">
        <h3 class="title">Po√©nos id≈ëj√°r√°s</h3>
        <div id="wx" class="box">Nyomd meg a gombot!</div>
        <button id="btnWx" class="chip ok" style="margin-top:10px">Friss jelent√©s</button>
      </div>
      <div class="card span-6">
        <h3 class="title">Mini-√≥ra</h3>
        <div id="clock" class="box">--:--:--</div>
      </div>
    </div>
  </section>

  <!-- Kv√≠z Bajnoks√°g -->
  <section id="quizpro" class="view">
    <div class="grid">
      <div class="card span-8" id="quizCard">
        <h3 class="title">Kv√≠z Bajnoks√°g ‚Äì 15 k√©rd√©s, 15 mp/k√©rd√©s</h3>

        <!-- Start -->
        <div id="quizStart">
          <div class="row" style="margin:8px 0">
            <label for="playerName" style="margin:0 10px 0 0; font-weight:800">N√©v:</label>
            <input id="playerName" type="text" placeholder="Neved" style="max-width:240px">
            <button id="quizGo" class="chip ok">Ind√≠t</button>
          </div>
          <p class="muted" style="margin-top:8px">V√°laszolj gyorsan √©s pontosan! Lej√°rt id≈ë = 0 pont.</p>
        </div>

        <!-- HUD -->
        <div id="quizHud" class="quizHud" style="display:none">
          <span class="badge">K√©rd√©s: <b id="qIdx">1</b>/15</span>
          <span class="badge">Pont: <b id="qScore">0</b></span>
          <span class="badge">Id≈ë: <b id="qTime">0.0s</b></span>
          <div class="meter"><span id="qBar"></span></div>
        </div>

        <!-- K√©rd√©s -->
        <div id="quizQWrap" style="display:none">
          <div id="qText" class="box">K√©rd√©s‚Ä¶</div>
          <div id="qAns" class="answers"></div>
        </div>

        <!-- Befejez√©s -->
        <div id="quizDone" style="display:none">
          <h3 class="title" style="margin-top:6px">Eredm√©ny</h3>
          <div class="box" id="quizSummary"></div>
          <div class="row" style="margin-top:10px">
            <button id="quizAgain" class="chip info">√öjra</button>
            <button id="quizReset" class="chip danger">Toplista t√∂rl√©se</button>
          </div>
        </div>
      </div>

      <div class="card span-4">
        <h3 class="title">Toplista (helyi)</h3>
        <table class="table" id="lbTable">
          <thead><tr><th>#</th><th>N√©v</th><th>Pont</th><th>Id≈ë</th></tr></thead>
          <tbody></tbody>
        </table>
        <p class="muted">A toplista az eszk√∂z√∂d√∂n t√°rol√≥dik (LocalStorage).</p>
      </div>
    </div>
  </section>

  <!-- Am≈ëba -->
  <section id="tictactoe" class="view">
    <div class="card">
      <h3 class="title">Am≈ëba (Tic-Tac-Toe)</h3>
      <div class="ttt-grid" id="tttGrid"></div>
      <div id="tttInfo" class="box" style="margin-top:10px;text-align:center">Te kezdesz: X</div>
      <div class="ttt-panel">
        <button id="tttReset" class="chip info">√öjrakezd</button>
        <label class="row" style="gap:6px">
          <input type="checkbox" id="tttCpu" checked>
          <span class="muted">J√°t√©k a g√©p ellen</span>
        </label>
      </div>
    </div>
  </section>

  <!-- Chat -->
  <section id="chat" class="view">
    <div class="card chat-wrap">
      <h3 class="title">Chat ‚Äì besz√©lgetek veled, s≈ët ‚Äûfel is aj√°nlom magam‚Äù üòè</h3>
      <div id="chatBox" class="chat-box"></div>
      <div class="chat-input">
        <input id="chatInput" type="text" placeholder="√çrj valamit‚Ä¶ (pl. szia, vicc, hogy vagy, seg√≠ts)">
        <button id="chatSend" class="chip ok">K√ºld√©s</button>
      </div>
      <div class="chat-tip">Tipp: √≠rj ‚Äûvicc‚Äù, ‚Äûpo√©n‚Äù, ‚Äûk√°v√©‚Äù, ‚Äûunalom‚Äù, ‚Äûseg√≠ts‚Äù, ‚Äûj√°t√©k‚Äù, stb.</div>
    </div>
  </section>
</main>

<!-- Chat megh√≠v√≥ bubor√©k -->
<div id="chatNudge" class="chat-nudge" style="display:none"></div>

<!-- Hangok -->
<audio id="prank"  src="prank_short.mp3"    preload="auto"></audio>
<audio id="talent" src="tehetseges.mp3.m4a" preload="auto"></audio>

<script>
/* ===== Hull√°mos h√°tt√©r + konfetti ===== */
const bg = document.getElementById('bgCanvas'), g = bg.getContext('2d');
const fx = document.getElementById('fxCanvas'), fg = fx.getContext('2d');
function fit(){ bg.width=fx.width=innerWidth; bg.height=fx.height=innerHeight; } addEventListener('resize', fit); fit();
let t=0; window.waveSpeed=0.006;
(function loop(){ t+=window.waveSpeed; g.clearRect(0,0,bg.width,bg.height);
  for(let i=-24;i<24;i++){
    g.beginPath(); g.moveTo(0,bg.height/2);
    for(let x=0;x<=bg.width;x+=8){
      const y = bg.height/2 + Math.sin(i/8 + t + x/140)*40 + i*5;
      g.lineTo(x,y);
    }
    g.strokeStyle = `hsla(${(i*10+t*180)%360},80%,65%,.45)`; g.lineWidth=2; g.stroke();
  } requestAnimationFrame(loop);
})();
const confetti=[]; function burstConfetti(cx=innerWidth/2,cy=innerHeight/2,n=120){
  for(let i=0;i<n;i++){ confetti.push({x:cx,y:cy,vx:(Math.random()*2-1)*4,vy:(Math.random()*-1-0.5)*6,g:0.12+Math.random()*0.1,life:60+Math.random()*40,c:`hsl(${Math.random()*360},90%,60%)`,s:2+Math.random()*3}); }
}
(function fxloop(){ fg.clearRect(0,0,fx.width,fx.height);
  for(let i=confetti.length-1;i>=0;i--){ const p=confetti[i]; p.vy+=p.g; p.x+=p.vx; p.y+=p.vy; p.life--; fg.fillStyle=p.c; fg.fillRect(p.x,p.y,p.s,p.s*2); if(p.life<=0||p.y>fx.height+20) confetti.splice(i,1);}
  requestAnimationFrame(fxloop);
})();

/* ===== Seg√©dek ===== */
const $=s=>document.querySelector(s); const $$=s=>document.querySelectorAll(s); const rnd=a=>a[Math.floor(Math.random()*a.length)];

/* ===== Adatok ===== */
const JOKES=["Mi√©rt nem megy a lift? Mert fel van h√∫zva!","Mit mond a nulla a nyolcasnak? ‚Äì Sz√©p √∂ved van!","A k√°v√© a v√°lasz. Mi is volt a k√©rd√©s? ü§î","A madarak nem haszn√°lj√°k a Facebookot, van Twitter√ºk.","Mi√©rt vitt a sz√°m√≠t√≥g√©p eserny≈ët? ‚Äì V√≠rusos id≈ë lesz.","Mit csin√°l a csiga a kocsm√°ban? ‚Äì Cs√∫szik."];
const WX=["Ma 100% es√©ly van po√©nz√°porra! ‚òîüòÇ","Holnap naps√ºt√©s √©s r√∂h√∂g√©shull√°m v√°rhat√≥. üåûü§£","Viharos nevet√©s k√∂zeleg! üí®üòÜ","Der√ºlt √©g, de a szomsz√©d viccei bebor√≠tanak. üå§","Nevet√©si front: mosoly √©szlelve. üå¶"];

/* ===== Login ===== */
const loading=$('#loading'), loadingText=$('#loadingText');
$('#form').addEventListener('submit', e=>{
  e.preventDefault();
  const name=$('#name').value.trim(), email=$('#email').value.trim(), pwd=$('#pwd').value.trim(), err=$('#err'); err.textContent='';
  if(!name||!email.includes('@')||pwd.length<4){ err.textContent='Ellen≈ërizd a mez≈ëket!'; return; }
  loading.style.display='grid';
  const texts=["K√°v√©szemek ≈ërl√©se‚Ä¶","V√≠z meleg√≠t√©se‚Ä¶","Cs√©sze el≈ëk√©sz√≠t√©se‚Ä¶","Humor ellen≈ërz√©se‚Ä¶"]; let i=0; const iv=setInterval(()=>{loadingText.textContent=texts[i++%texts.length];},800);
  setTimeout(()=>{ clearInterval(iv); loading.style.display='none'; $('#loginView').style.display='none'; $('#appbar').style.display='flex'; $('#jokeBox').textContent=rnd(JOKES); const o=window.waveSpeed; window.waveSpeed=0.02; burstConfetti(innerWidth/2,120); setTimeout(()=>window.waveSpeed=o,1800); },1400);
});

/* ===== Tabs + kv√≠z-t√©ma ===== */
$$('#tabs .tab').forEach(tab=>{
  tab.addEventListener('click', ()=>{
    $$('#tabs .tab').forEach(t=>t.classList.remove('active')); tab.classList.add('active');
    const view=tab.getAttribute('data-view');
    $$('.view').forEach(v=>v.classList.remove('active')); $('#'+view).classList.add('active');
    if(view==='quizpro') document.body.classList.add('quiz-theme'); else document.body.classList.remove('quiz-theme');
  });
});

/* ===== Po√©n gener√°tor ===== */
$('#btnJoke').addEventListener('click',()=>$('#jokeBox').textContent=rnd(JOKES));
$('#btnThree').addEventListener('click',()=>{ const list=[rnd(JOKES),rnd(JOKES),rnd(JOKES)]; $('#jokeBox').innerHTML="<ul style='margin:6px 0 0 16px'>"+list.map(j=>`<li>${j}</li>`).join("")+"</ul>"; });

/* ===== Hangok ===== */
const A_PRANK=$('#prank'), A_TALENT=$('#talent');
function stopAll(){try{A_PRANK.pause();A_TALENT.pause();}catch{}}
function playById(id){ stopAll(); const a=id==='talent'?A_TALENT:A_PRANK; a.currentTime=0; a.play().catch(()=>alert('Kattints az oldalra, hogy a b√∂ng√©sz≈ë engedje a hangot!')); }
$$('[data-sound]').forEach(b=>b.addEventListener('click',e=>{ const r=e.target.getBoundingClientRect(); burstConfetti(r.left+r.width/2, r.top+scrollY); playById(b.getAttribute('data-sound')); }));

/* ===== J√°t√©kok ===== */
let you=0,cpu=0; const youEl=$('#youScore'), cpuEl=$('#cpuScore'), rpsOut=$('#rpsOut');
$('#rpsReset').addEventListener('click',()=>{you=0;cpu=0;youEl.textContent=0;cpuEl.textContent=0;rpsOut.textContent='V√°lassz egyet!';});
$('#games').querySelectorAll('.pick').forEach(p=>p.addEventListener('click',e=>{
  const user=p.getAttribute('data-pick'), comp=rnd(['K≈ë','Pap√≠r','Oll√≥']); let res='Vesztett√©l!';
  if(user===comp) res='D√∂ntetlen!'; else if((user==='K≈ë'&&comp==='Oll√≥')||(user==='Pap√≠r'&&comp==='K≈ë')||(user==='Oll√≥'&&comp==='Pap√≠r')){res='Nyert√©l!'; you++; const r=e.target.getBoundingClientRect(); burstConfetti(r.left+r.width/2, r.top+scrollY);} else cpu++;
  youEl.textContent=you; cpuEl.textContent=cpu; rpsOut.textContent=`Te: ${user} | G√©p: ${comp} ‚Üí ${res}`;
}));
let secret=1+Math.floor(Math.random()*10);
$('#guessBtn').addEventListener('click',()=>{ const v=parseInt($('#guessIn').value,10); if(isNaN(v)){$('#guessOut').textContent='Adj meg egy sz√°mot!';return;}
  if(v===secret){ $('#guessOut').textContent=`Eltal√°ltad! (${secret}) üéâ`; burstConfetti(innerWidth/2, innerHeight/2);} else if(v<secret) $('#guessOut').textContent='Nagyobb! ‚¨ÜÔ∏è'; else $('#guessOut').textContent='Kisebb! ‚¨áÔ∏è';
});
$('#guessNew').addEventListener('click',()=>{ secret=1+Math.floor(Math.random()*10); $('#guessOut').textContent='√öj sz√°m k√©sz!'; $('#guessIn').value=''; });

/* ===== Id≈ëj√°r√°s + √≥ra ===== */
$('#btnWx').addEventListener('click',()=>$('#wx').textContent=rnd(WX));
(function tick(){ const d=new Date(); $('#clock').textContent=d.toLocaleTimeString('hu-HU',{hour12:false}); requestAnimationFrame(tick); })();

/* ===== Kv√≠z ===== */
const QUESTIONS=[
  {q:"Melyik √°llat alszik a legt√∂bbet?",a:["Koala","Oroszl√°n","Macska","Panda"],c:0},
  {q:"Melyik bolyg√≥ a ‚Äûv√∂r√∂s‚Äù?",a:["Mars","V√©nusz","Jupiter","Szaturnusz"],c:0},
  {q:"Mennyi 9√ó7?",a:["56","63","72","49"],c:1},
  {q:"Mi a H2O?",a:["Oxig√©n","Hidrog√©n","V√≠z","S√≥sav"],c:2},
  {q:"Melyik f≈ëv√°ros? B√©cs",a:["Sv√°jc","Ausztria","Belgium","Csehorsz√°g"],c:1},
  {q:"Melyik n√∂v√©ny f≈±szer?",a:["Bazsalikom","Ny√≠rfa","Feny≈ë","T√∂lgy"],c:0},
  {q:"HTML-ben linket melyik tag?",a:["<div>","<a>","<link>","<p>"],c:1},
  {q:"Mennyi a œÄ kb.?",a:["2.14","3.14","3.41","4.13"],c:1},
  {q:"Melyik nem programnyelv?",a:["Python","Ruby","Photoshop","Go"],c:2},
  {q:"Magyarorsz√°g f≈ëv√°rosa?",a:["Debrecen","Gy≈ër","Budapest","Szeged"],c:2},
  {q:"RGB-ben a B?",a:["Black","Blue","Brown","Bright"],c:1},
  {q:"H√°ny nap egy h√©t?",a:["5","6","7","8"],c:2},
  {q:"Melyik reptet?",a:["Strucc","Sas","Pingvin","Kivi"],c:1},
  {q:"HTTP S bet≈±je?",a:["Secure","Simple","Serial","Service"],c:0},
  {q:"CSS mire j√≥?",a:["Adatb√°zis","St√≠lus","Szerver","Teszt"],c:1},
];
const lbKey='quizLeaderboardV1', lbEl=document.querySelector('#lbTable tbody');
function loadLB(){try{return JSON.parse(localStorage.getItem(lbKey)||'[]')}catch{return []}}
function saveLB(arr){localStorage.setItem(lbKey,JSON.stringify(arr.slice(0,20)));}
function formatTime(ms){return (ms/1000).toFixed(1)+'s';}
function renderLB(){ const lb=loadLB().sort((a,b)=>(b.score-a.score)||(a.time-b.time));
  lbEl.innerHTML=lb.slice(0,10).map((r,i)=>`<tr><td>${i+1}</td><td>${r.name||'N√©vtelen'}</td><td>${r.score}/15</td><td>${formatTime(r.time)}</td></tr>`).join('')||'<tr><td colspan="4" class="muted">M√©g nincs eredm√©ny.</td></tr>';
}
renderLB();
const quizStart=$('#quizStart'), quizHud=$('#quizHud'), quizQWrap=$('#quizQWrap'), quizDone=$('#quizDone');
const qIdxEl=$('#qIdx'), qScoreEl=$('#qScore'), qTimeEl=$('#qTime'), qBar=$('#qBar'), qText=$('#qText'), qAns=$('#qAns'), quizSummary=$('#quizSummary');
let qi=0,qScore=0,qStart=0,qTimer=null,qEndAt=0,player='';
function startQuiz(){ player=($('#playerName').value||$('#name').value||'Vend√©g').trim(); qi=0;qScore=0; quizStart.style.display='none'; quizDone.style.display='none'; quizHud.style.display='flex'; quizQWrap.style.display='block'; qStart=performance.now(); nextQuestion(); }
function nextQuestion(){
  if(qi>=QUESTIONS.length){ return finishQuiz(); }
  const Q=QUESTIONS[qi]; qIdxEl.textContent=(qi+1); qScoreEl.textContent=qScore; qText.textContent=Q.q; qAns.innerHTML='';
  Q.a.forEach((txt,idx)=>{ const b=document.createElement('button'); b.className='ans'; b.textContent=txt; b.addEventListener('click',()=>choose(idx)); qAns.appendChild(b); });
  const D=15000; qEndAt=performance.now()+D; if(qTimer) cancelAnimationFrame(qTimer);
  (function tickBar(){ const left=Math.max(0,qEndAt-performance.now()); const ratio=left/D; qBar.style.transform=`scaleX(${ratio})`; qTimeEl.textContent=((performance.now()-qStart)/1000).toFixed(1)+'s';
    if(left<=0){ lock(false); setTimeout(()=>{qi++;nextQuestion();},600);} else { qTimer=requestAnimationFrame(tickBar); }
  })();
  function choose(idx){ if(qTimer){cancelAnimationFrame(qTimer); qTimer=null;} const ok=(idx===Q.c); if(ok) qScore++; lock(ok,idx); setTimeout(()=>{qi++;nextQuestion();},600); }
  function lock(ok,picked=-1){ [...qAns.children].forEach((btn,i)=>{ if(i===Q.c) btn.classList.add('correct'); if(i===picked&&i!==Q.c) btn.classList.add('wrong'); btn.disabled=true; }); }
}
function finishQuiz(){
  if(qTimer){cancelAnimationFrame(qTimer); qTimer=null;}
  const totalMs=performance.now()-qStart; quizHud.style.display='none'; quizQWrap.style.display='none'; quizDone.style.display='block';
  quizSummary.innerHTML=`<p><b>${player}</b>, eredm√©nyed: <b>${qScore}/15</b>, id≈ë: <b>${formatTime(totalMs)}</b>.</p>`;
  const lb=loadLB(); lb.push({name:player,score:qScore,time:totalMs,date:Date.now()});
  saveLB(lb.sort((a,b)=>(b.score-a.score)||(a.time-b.time))); renderLB(); burstConfetti(innerWidth/2,160,180);
}
document.getElementById('quizGo').addEventListener('click', startQuiz);
document.getElementById('quizAgain').addEventListener('click', ()=>{ quizStart.style.display='block'; quizDone.style.display='none'; });
document.getElementById('quizReset').addEventListener('click', ()=>{ if(confirm('Biztos t√∂rl√∂d a toplist√°t?')){ localStorage.removeItem(lbKey); renderLB(); }});

/* ===== Am≈ëba (fixelt AI) ===== */
const tttGrid=$('#tttGrid'), tttInfo=$('#tttInfo'), tttCpu=$('#tttCpu'); let board, playerTurn, gameOver;
function initTTT(){ board=Array(9).fill(null); playerTurn='X'; gameOver=false; tttGrid.innerHTML=''; for(let i=0;i<9;i++){ const c=document.createElement('div'); c.className='ttt-cell'; c.dataset.idx=i; c.addEventListener('click',()=>tttPlay(i)); tttGrid.appendChild(c);} tttInfo.textContent="Te kezdesz: X"; }
function winLines(){return [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];}
function winner(){ for(const [a,b1,c] of winLines()){ if(board[a]&&board[a]===board[b1]&&board[a]===board[c]) return {p:board[a],line:[a,b1,c]}; } if(board.every(Boolean)) return {p:'D',line:[]}; return null; }
function bestMove(mark){ const opp=mark==='X'?'O':'X';
  for(let i=0;i<9;i++){ if(!board[i]){ board[i]=mark; if(winner()?.p===mark){ board[i]=null; return i;} board[i]=null; } }
  for(let i=0;i<9;i++){ if(!board[i]){ board[i]=opp;  if(winner()?.p===opp ){ board[i]=null; return i;} board[i]=null; } }
  if(!board[4]) return 4; const corners=[0,2,6,8].filter(i=>!board[i]); if(corners.length) return rnd(corners); const sides=[1,3,5,7].filter(i=>!board[i]); if(sides.length) return rnd(sides); return board.findIndex(v=>!v);
}
function tttPlay(i){ if(gameOver||board[i])return; board[i]=playerTurn; renderTTT(); const w=winner(); if(w){endTTT(w);return;}
  if(tttCpu.checked){ playerTurn='O'; setTimeout(()=>{ const mv=bestMove('O'); if(mv>=0&&!gameOver){ board[mv]='O'; renderTTT(); const w2=winner(); if(w2){endTTT(w2);return;} playerTurn='X'; tttInfo.textContent="Te j√∂ssz: X"; }},250);
  } else { playerTurn=(playerTurn==='X'?'O':'X'); tttInfo.textContent=`K√∂vetkez≈ë: ${playerTurn}`; }
}
function renderTTT(){ [...tttGrid.children].forEach((cell,i)=>{ cell.textContent=board[i]||''; cell.classList.remove('win'); }); }
function endTTT(res){ gameOver=true; if(res.p==='D'){ tttInfo.textContent="D√∂ntetlen!"; return; } res.line.forEach(idx=>tttGrid.children[idx].classList.add('win'));
  if(res.p==='X'){ tttInfo.textContent="Gratul√°lok, √ºgyes vagy! üéâ Te nyert√©l!"; burstConfetti(innerWidth/2, innerHeight/3, 160);} else { tttInfo.textContent="A g√©p nyert. √öjra?"; }
}
$('#tttReset').addEventListener('click', initTTT); initTTT();

/* ===== Chat ===== */
const chatBox=$('#chatBox'), chatInput=$('#chatInput');
function pushMsg(txt,who='user'){ const b=document.createElement('div'); b.className='msg '+(who==='user'?'user':'bot'); b.textContent=txt; chatBox.appendChild(b); chatBox.scrollTop=chatBox.scrollHeight; }
const botFallback=["√ârtem‚Ä¶ vagy m√©gsem? ü§î Mes√©lj t√∂bbet!","K√°v√© ut√°n minden jobb. K√©rsz? ‚òï","Mondan√©k egy viccet, de f√©lek, hogy a b√∂ng√©sz≈ëd lefagy a nevet√©st≈ël.","Ha ez egy rejtv√©ny, akkor J√ìL csin√°lod. üòÑ","Hmm‚Ä¶ √©rdekes. Kattints a J√°t√©kok men√ºpontra k√∂zben!"];
const botVicc=["Mi√©rt vitt a sz√°m√≠t√≥g√©p eserny≈ët? ‚Äì V√≠rusos id≈ë lesz.","Mit mond a nulla a nyolcasnak? ‚Äì Sz√©p √∂ved van!","A k√°v√© a v√°lasz. Mi is volt a k√©rd√©s? ü§î"];
function botReply(t0){ const t=t0.toLowerCase();
  if(/szia|hell√≥|hello|hali/.test(t)) return "Szia! Hogy vagy? √ân 0‚Äì1 k√∂z√∂tt √©rzem magam. üòé";
  if(/hogy vagy\??/.test(t)) return "Remek√ºl! A hull√°maim is ezt mutatj√°k. üåä";
  if(/vicc|po[e√©]n/.test(t)) return rnd(botVicc);
  if(/k[a√°]v[e√©]/.test(t)) return "K√°v√©? Mindig! ‚òï Addig is: nyomd meg a ‚ÄûM√©g egy po√©n‚Äù gombot!";
  if(/seg[i√≠]ts|help|hogyan/.test(t)) return "Seg√≠tek: fent a men√ºben a J√°t√©kokn√°l van K≈ë‚ÄìPap√≠r‚ÄìOll√≥ √©s Sz√°mkital√°l√≥, a Kv√≠zben pedig 15 k√©rd√©s v√°r!";
  if(/j[a√°]t[e√©]k|game/.test(t)) return "J√°tszunk! Menj a J√°t√©kok vagy az Am≈ëba men√ºbe! üéÆ";
  if(/unalom|unatkoz/.test(t)) return "Unalom ellen fel√≠rom: 2x po√©ngener√°tor, 1x kv√≠z, 1x am≈ëba. Jelentkezzen vissza, ha hatott! üòÅ";
  if(t.length>80) return "Ez hossz√∫ volt! Egy TL;DR-t is k√©rhetek? üòÖ";
  if(/\?$/.test(t)) return "J√≥ k√©rd√©s! Ha √©n tudn√°m, m√°r mem√©ben is elmondtam volna. ü§ñ";
  return rnd(botFallback);
}
document.getElementById('chatSend').addEventListener('click', ()=>{ const v=chatInput.value.trim(); if(!v) return; pushMsg(v,'user'); chatInput.value=''; setTimeout(()=>pushMsg(botReply(v),'bot'),400); });
chatInput.addEventListener('keydown',e=>{ if(e.key==='Enter'){ document.getElementById('chatSend').click(); }});
</script>
</body>
</html>

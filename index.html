<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vicck√∂zpont v10</title>
<style>
  body,html {margin:0;padding:0;font-family:Arial, sans-serif;overflow-x:hidden;}
  #loginView, #loading, #appbar {display:none;}
  #loginView {display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh;}
  #loginView input, #loginView button {margin:5px;padding:10px;font-size:16px;}
  #loading {place-items:center;height:100vh;font-size:24px;}
  #appbar {background:#333;color:#fff;padding:10px;display:flex;gap:10px;}
  .section {padding:20px;}
  #quizArea, #tictactoe, #chatArea {margin-top:20px;}
  #quizArea button, #tictactoe button, #chatArea button {padding:10px;margin:5px;}
  #lbTable {border-collapse:collapse;width:100%;}
  #lbTable th, #lbTable td {border:1px solid #ccc;padding:8px;text-align:left;}
  canvas {position:fixed;top:0;left:0;z-index:-1;}
</style>
</head>
<body>

<div id="loginView">
  <h1>Vicck√∂zpont Bel√©p√©s</h1>
  <form id="form">
    <input id="name" placeholder="N√©v">
    <input id="email" placeholder="Email">
    <input id="pwd" type="password" placeholder="Jelsz√≥">
    <div id="err" style="color:red;"></div>
    <button type="submit">Bel√©p√©s</button>
  </form>
</div>

<div id="loading"><div id="loadingText">Bet√∂lt√©s...</div></div>

<div id="appbar">
  <button onclick="showSection('quizArea')">Kv√≠z</button>
  <button onclick="showSection('tictactoe')">Am≈ëba</button>
  <button onclick="showSection('chatArea')">Chat</button>
</div>

<div class="section" id="quizArea" style="display:none;">
  <h2>Kv√≠z</h2>
  <div id="quizQ"></div>
  <div id="quizOpts"></div>
  <div id="quizTimer"></div>
  <div id="lb"></div>
</div>

<div class="section" id="tictactoe" style="display:none;">
  <h2>Am≈ëba</h2>
  <div id="board" style="display:grid;grid-template-columns:repeat(3,80px);gap:5px;"></div>
  <div id="tttMsg"></div>
</div>

<div class="section" id="chatArea" style="display:none;">
  <h2>Chat</h2>
  <div id="chatLog" style="border:1px solid #ccc;height:200px;overflow-y:auto;padding:5px;"></div>
  <input id="chatInput" placeholder="√çrj valamit...">
  <button onclick="sendChat()">K√ºld√©s</button>
</div>

<script>
// ---- Hull√°mos h√°tt√©r jav√≠tva ----
let t = 0;
window.waveSpeed = 0.006;
const canvas = document.createElement('canvas');
document.body.prepend(canvas);
const ctx = canvas.getContext('2d');
function resizeCanvas(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();
function drawWave(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  const colors = ['#ff006e','#8338ec','#3a86ff','#ffbe0b','#fb5607'];
  const amp = 50;
  const freq = 0.02;
  for (let j=0;j<colors.length;j++){
    ctx.beginPath();
    ctx.moveTo(0, canvas.height/2);
    for (let x=0; x<canvas.width; x++){
      const y = Math.sin((x*freq)+(t+j)) * amp + (canvas.height/2);
      ctx.lineTo(x, y);
    }
    ctx.strokeStyle = colors[j];
    ctx.lineWidth = 2;
    ctx.stroke();
  }
  t += window.waveSpeed;
  requestAnimationFrame(drawWave);
}
drawWave();

// ---- Login jav√≠tva ----
document.addEventListener('DOMContentLoaded', () => {
  document.getElementById('loginView').style.display='flex';
  const form = document.getElementById('form');
  const loading = document.getElementById('loading');
  const loadingText = document.getElementById('loadingText');
  form.addEventListener('submit', e => {
    e.preventDefault();
    const name  = document.getElementById('name').value.trim();
    const email = document.getElementById('email').value.trim();
    const pwd   = document.getElementById('pwd').value.trim();
    const err   = document.getElementById('err');
    err.textContent = '';
    if (!name || !email.includes('@') || pwd.length < 4) {
      err.textContent = 'Ellen≈ërizd a mez≈ëket!';
      return;
    }
    loading.style.display = 'grid';
    const texts = ["K√°v√©szemek ≈ërl√©se‚Ä¶","V√≠z meleg√≠t√©se‚Ä¶","Cs√©sze el≈ëk√©sz√≠t√©se‚Ä¶","Humor ellen≈ërz√©se‚Ä¶"];
    let i=0; 
    const iv=setInterval(()=>{ loadingText.textContent=texts[i++%texts.length]; }, 800);
    setTimeout(()=>{
      clearInterval(iv);
      loading.style.display='none';
      document.getElementById('loginView').style.display='none';
      document.getElementById('appbar').style.display='flex';
      window.waveSpeed = 0.02;
      setTimeout(()=> window.waveSpeed = 0.006, 1800);
    }, 1400);
  });
});

// ---- Kv√≠z ----
let quizQuestions = [
  {q:"Melyik a vil√°g legnagyobb √°llata?", o:["K√©k b√°lna","Afrikai elef√°nt","Z√∂ld anakonda"], a:0},
  {q:"H√°ny nap van egy √©vben?", o:["365","366","364"], a:0},
];
let score=0, currentQ=0, quizTimer, quizStartTime;
function startQuiz(){
  score=0;currentQ=0;
  quizStartTime=Date.now();
  showQuestion();
}
function showQuestion(){
  const q = quizQuestions[currentQ];
  document.getElementById('quizQ').textContent = q.q;
  const optsDiv = document.getElementById('quizOpts');
  optsDiv.innerHTML='';
  q.o.forEach((opt,i)=>{
    const btn = document.createElement('button');
    btn.textContent = opt;
    btn.onclick = ()=> checkAnswer(i);
    optsDiv.appendChild(btn);
  });
  let timeLeft = 15;
  document.getElementById('quizTimer').textContent = timeLeft;
  clearInterval(quizTimer);
  quizTimer = setInterval(()=>{
    timeLeft--;
    document.getElementById('quizTimer').textContent = timeLeft;
    if (timeLeft<=0){clearInterval(quizTimer);nextQuestion();}
  },1000);
}
function checkAnswer(i){
  if (i === quizQuestions[currentQ].a) score++;
  nextQuestion();
}
function nextQuestion(){
  currentQ++;
  if (currentQ<quizQuestions.length) showQuestion();
  else finishQuiz();
}
function loadLB(){return JSON.parse(localStorage.getItem('lb')||'[]');}
function saveLB(data){localStorage.setItem('lb',JSON.stringify(data));}
function showLeaderboard(){
  const lb = loadLB();
  let html = "<h3>Toplista</h3><table id='lbTable'><tr><th>N√©v</th><th>Pont</th><th>Id≈ë</th></tr>";
  lb.forEach(e=>{html += `<tr><td>${e.name}</td><td>${e.score}</td><td>${e.time}s</td></tr>`;});
  html += "</table>";
  document.getElementById('lb').innerHTML = html;
}
function finishQuiz(){
  const timeTaken = Math.floor((Date.now() - quizStartTime) / 1000);
  alert(`Kv√≠z v√©ge! Pontsz√°m: ${score}/${quizQuestions.length}`);
  const lb = loadLB();
  lb.push({ name: document.getElementById('name').value, score, time: timeTaken });
  saveLB(lb.sort((a,b) => (b.score - a.score) || (a.time - b.time)));
  showLeaderboard();
}

// ---- Am≈ëba ----
let board = Array(9).fill(null);
function startTTT(){
  board.fill(null);
  const b = document.getElementById('board');
  b.innerHTML='';
  for(let i=0;i<9;i++){
    const cell = document.createElement('button');
    cell.style.height='80px';
    cell.onclick = ()=> move(i,'X');
    b.appendChild(cell);
  }
  document.getElementById('tttMsg').textContent='';
}
function move(i,mark){
  if (board[i]) return;
  board[i]=mark;
  document.getElementById('board').children[i].textContent = mark;
  if (winner(board)?.p){document.getElementById('tttMsg').textContent="Gratul√°lok, √ºgyes vagy!";return;}
  if (!board.includes(null)){document.getElementById('tttMsg').textContent="D√∂ntetlen!";return;}
  const aiMove = bestMove('O');
  if (aiMove!==null) move(aiMove,'O');
}
function winner(b){
  const wins = [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
  for (let [a,c,d] of wins){
    if (b[a] && b[a]===b[c] && b[a]===b[d]) return {p:b[a]};
  }
  return null;
}
function rnd(arr){return arr[Math.floor(Math.random()*arr.length)];}
function bestMove(mark){
  const opp = mark==='X'?'O':'X';
  for (let i=0;i<9;i++){
    if (!board[i]){board[i]=mark;if (winner(board)?.p===mark){board[i]=null;return i;}board[i]=null;}
  }
  for (let i=0;i<9;i++){
    if (!board[i]){board[i]=opp;if (winner(board)?.p===opp){board[i]=null;return i;}board[i]=null;}
  }
  if (!board[4]) return 4;
  const corners=[0,2,6,8].filter(i=>!board[i]);
  if (corners.length) return rnd(corners);
  const sides=[1,3,5,7].filter(i=>!board[i]);
  if (sides.length) return rnd(sides);
  return board.findIndex(v=>!v);
}

// ---- Chat ----
const chatLog = [];
function sendChat(){
  const inp = document.getElementById('chatInput');
  const msg = inp.value.trim();
  if (!msg) return;
  addChat('Te', msg);
  inp.value='';
  respond(msg);
}
function addChat(user,text){
  const log = document.getElementById('chatLog');
  const div = document.createElement('div');
  div.innerHTML = `<b>${user}:</b> ${text}`;
  log.appendChild(div);
  log.scrollTop = log.scrollHeight;
}
function respond(msg){
  const low = msg.toLowerCase();
  let res;
  if (low.includes('szia')) res="Szia haver! Hogy vagy?";
  else if (low.includes('hogy vagy')) res="√ân mindig j√≥l vagyok üòÑ";
  else if (low.includes('vicc')) res="Hallod, a tegnapi viccemet m√©g a g√©p sem √©rtette!";
  else res=["Hmm... √©rdekes üòè","Nem tudom, de j√≥l hangzik!","Biztos vagy ebben?","Ez tetszik!"][Math.floor(Math.random()*4)];
  setTimeout(()=> addChat('Bot',res),500);
}

// ---- Section v√°lt√°s ----
function showSection(id){
  document.querySelectorAll('.section').forEach(s=>s.style.display='none');
  document.getElementById(id).style.display='block';
  if (id==='quizArea') startQuiz();
  if (id==='tictactoe') startTTT();
}
</script>

</body>
</html>

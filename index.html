<!doctype html>
<html lang="hu">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Vicck√∂zpont ‚Äì Desktop Edition (3D h√°tt√©r + mozgathat√≥ ablakok)</title>
<style>
:root{
  --bg:#070b17; --text:#e8edff; --muted:#a7b1d6; --line:rgba(255,255,255,.14);
  --glass:rgba(255,255,255,.06);
  --brand1:#7c3aed; --brand2:#22d3ee;
  --ok:#22c55e; --info:#60a5fa; --warn:#f59e0b; --danger:#ef4444;
  --goodGrad:linear-gradient(90deg,#22c55e,#16a34a);
  --infoGrad:linear-gradient(90deg,#60a5fa,#3b82f6);
}
*{box-sizing:border-box}
html,body{height:100%;margin:0}
body{background:var(--bg); color:var(--text); font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif; overflow:hidden}
a{color:inherit}

/* 3D h√°tt√©r v√°szon */
#bg3d{position:fixed; inset:0; z-index:0; display:block}

/* App bar (login ut√°n) */
.appbar{position:fixed; top:0; left:0; right:0; z-index:3; display:none;
  padding:10px 14px; gap:10px; align-items:center;
  background:linear-gradient(180deg, rgba(12,18,36,.85), rgba(12,18,36,.55));
  backdrop-filter:blur(10px); border-bottom:1px solid var(--line) }
.logo{display:flex; align-items:center; gap:10px; font-weight:900}
.logo .dot{width:12px;height:12px;border-radius:50%;background:linear-gradient(90deg,var(--brand1),var(--brand2)); box-shadow:0 0 18px #22d3ee90}
.appbar .profile{margin-left:auto; display:flex; align-items:center; gap:10px; font-weight:700; color:#cfe1ff}

/* Launcher s√°v alul */
.dock{position:fixed; left:50%; transform:translateX(-50%); bottom:16px; z-index:3; display:none; gap:10px;
  background:linear-gradient(180deg, rgba(255,255,255,.1), rgba(255,255,255,.06)); border:1px solid var(--line); border-radius:16px; padding:8px 10px; backdrop-filter:blur(10px)}
.dock .btn{padding:10px 12px; border-radius:12px; border:1px solid var(--line); background:var(--glass); cursor:pointer; font-weight:800}
.dock .btn.ok{background:var(--goodGrad); color:#062215; border-color:transparent}
.dock .btn.info{background:var(--infoGrad); color:#071321; border-color:transparent}

/* Login k√°rtya */
.auth{position:relative; z-index:2; max-width:440px; margin:80px auto; padding:24px; border-radius:16px;
  background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
  border:1px solid var(--line); backdrop-filter:blur(10px); box-shadow:0 30px 80px rgba(0,0,0,.35)}
label{display:block; font-weight:800; margin:12px 0 6px}
input{width:100%; padding:12px 14px; border-radius:12px; border:1px solid var(--line); background:rgba(255,255,255,.06); color:var(--text)}
.btn{display:inline-flex; align-items:center; justify-content:center; gap:8px; padding:12px 16px; border:0; border-radius:12px; font-weight:900; cursor:pointer}
.btn.full{width:100%}
.btn.green{background:var(--goodGrad); color:#062215; box-shadow:0 10px 30px rgba(34,197,94,.25)}
.err{color:#fecaca; font-weight:800; min-height:18px; margin-top:10px}
.muted{color:var(--muted)}

/* Loading overlay */
#loading{position:fixed; inset:0; z-index:4; display:none; place-items:center;
  background:rgba(8,12,30,.6); backdrop-filter:blur(6px)}
.loader{width:min(360px,92vw); padding:18px; border-radius:14px;
  background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
  border:1px solid var(--line); text-align:center; box-shadow:0 20px 60px rgba(0,0,0,.45)}

/* Window rendszer */
.window{position:fixed; z-index:2; min-width:320px; max-width:92vw; min-height:220px;
  background:linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.06));
  border:1px solid var(--line); border-radius:14px; box-shadow:0 20px 60px rgba(0,0,0,.45); backdrop-filter:blur(10px); display:none}
.titlebar{display:flex; align-items:center; gap:8px; padding:10px 12px; cursor:move; border-bottom:1px solid var(--line)}
.titlebar .dot{width:10px;height:10px;border-radius:50%}
.titlebar .dot.red{background:#ef4444} .titlebar .dot.yellow{background:#f59e0b} .titlebar .dot.green{background:#22c55e}
.titlebar .title{font-weight:900; margin-left:6px}
.win-content{padding:12px; max-height:70vh; overflow:auto}

/* K√°rty√°k + elemek a panelekben */
.box{border:1px solid var(--line); border-radius:12px; background:rgba(10,12,22,.6); padding:12px}
.row{display:flex; gap:8px; flex-wrap:wrap; align-items:center}
.chip{padding:8px 12px; border-radius:999px; border:1px solid var(--line); background:var(--glass); cursor:pointer; font-weight:800}
.chip.ok{background:var(--goodGrad); color:#062215; border-color:transparent}
.chip.info{background:var(--infoGrad); color:#071321; border-color:transparent}

/* Kv√≠z ‚Äì feh√©r k√°rtya t√©ma az ablakon bel√ºl */
.quiz-card{background:#fff; color:#000; border-radius:12px; padding:12px; border:1px solid rgba(0,0,0,.1)}
.quiz-card .box{background:#f9f9f9; color:#000; border:1px solid rgba(0,0,0,.1)}
.answers{display:grid; grid-template-columns:repeat(2,1fr); gap:10px; margin-top:10px}
.ans{padding:12px; border-radius:12px; border:1px solid rgba(0,0,0,.1); background:#f9f9f9; cursor:pointer; font-weight:800}
.ans.correct{outline:2px solid #22c55e}
.ans.wrong{outline:2px solid #ef4444}
.badge{padding:6px 10px; background:#eef2ff; color:#111827; border:1px solid rgba(0,0,0,.08); border-radius:999px}
.meter{flex:1; height:10px; background:#e5e7eb; border:1px solid rgba(0,0,0,.08); border-radius:999px; overflow:hidden}
.meter>span{display:block; height:100%; width:100%; background:linear-gradient(90deg,#ef4444,#dc2626); transform-origin:left; transform:scaleX(1); transition:transform .2s linear}

/* Am≈ëba */
.ttt-grid{display:grid; grid-template-columns:repeat(3,100px); grid-template-rows:repeat(3,100px); gap:8px; justify-content:center}
.ttt-cell{display:grid; place-items:center; font-size:36px; font-weight:900; border-radius:12px; background:rgba(255,255,255,.10); border:1px solid var(--line); cursor:pointer; user-select:none}
.ttt-cell.win{background:linear-gradient(180deg, rgba(34,197,94,.25), rgba(34,197,94,.15))}
.ttt-panel{display:flex; gap:10px; align-items:center; justify-content:center; flex-wrap:wrap; margin-top:10px}

/* Chat */
.chat-box{height:320px; border:1px solid var(--line); background:rgba(10,12,22,.55); border-radius:14px; padding:12px; overflow:auto; scroll-behavior:smooth}
.msg{max-width:70%; padding:10px 12px; border-radius:12px; margin:8px 0; line-height:1.3; word-wrap:break-word}
.user{margin-left:auto; background:linear-gradient(180deg, rgba(96,165,250,.25), rgba(96,165,250,.15)); border:1px solid #60a5fa55}
.bot{margin-right:auto; background:linear-gradient(180deg, rgba(124,58,237,.25), rgba(124,58,237,.15)); border:1px solid #7c3aed55}
.chat-input{display:flex; gap:8px; margin-top:10px}
.chat-input input{flex:1}

/* Rejtett a kezdeti √°llapotban */
#desktop{display:none}
</style>
</head>
<body>

<canvas id="bg3d"></canvas>

<header class="appbar" id="appbar">
  <div class="logo"><span class="dot"></span> Vicck√∂zpont ‚Äì Desktop</div>
  <div class="profile" id="profileName"></div>
</header>

<!-- Launcher (dock) -->
<div class="dock" id="dock">
  <button class="btn info" data-open="#winQuiz">Kv√≠z</button>
  <button class="btn info" data-open="#winTtt">Am≈ëba</button>
  <button class="btn info" data-open="#winChat">Chat</button>
  <button class="btn info" data-open="#winMedia">Hangok & Id≈ëj√°r√°s</button>
  <button class="btn" id="btnCenter">Ablakok k√∂z√©pre</button>
</div>

<!-- LOGIN -->
<main id="loginWrap" class="auth">
  <h1>Bejelentkez√©s</h1>
  <p class="muted">Modern ‚Äûdesktop‚Äù √©lm√©ny: kv√≠z, am≈ëba, chat ‚Äì mozgathat√≥ ablakokban, 3D h√°tt√©rrel. üî•</p>
  <form id="form" novalidate>
    <label for="name">N√©v</label>
    <input id="name" type="text" required placeholder="N√©v">
    <label for="email">Email</label>
    <input id="email" type="email" required placeholder="valami@email.hu">
    <label for="pwd">Jelsz√≥</label>
    <input id="pwd" type="password" minlength="4" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
    <button class="btn green full" type="submit">Bel√©pek</button>
    <div id="err" class="err"></div>
  </form>
</main>

<!-- Loading -->
<div id="loading"><div class="loader"><div id="loadingText">K√°v√©szemek ≈ërl√©se‚Ä¶</div></div></div>

<!-- DESKTOP ABLAKOK -->
<div id="desktop">
  <!-- Kv√≠z -->
  <div class="window" id="winQuiz" style="top:84px; left:40px; width:620px;">
    <div class="titlebar"><span class="dot red"></span><span class="dot yellow"></span><span class="dot green"></span><div class="title">Kv√≠z Bajnoks√°g</div></div>
    <div class="win-content">
      <div class="quiz-card">
        <h3 style="margin:6px 0 10px">15 k√©rd√©s ‚Ä¢ 15 mp/k√©rd√©s</h3>
        <div id="quizStart">
          <div class="row" style="margin:8px 0">
            <label for="playerName" style="margin:0 10px 0 0; font-weight:800;color:#111">N√©v:</label>
            <input id="playerName" type="text" placeholder="Neved" style="max-width:240px;background:#fff;color:#111;border:1px solid #e5e7eb">
            <button id="quizGo" class="chip ok">Ind√≠t</button>
          </div>
          <p class="muted" style="color:#333">Lej√°rt id≈ë = 0 pont. Hajr√°! üèÅ</p>
        </div>
        <div class="row quizHud" id="quizHud" style="display:none">
          <span class="badge">K√©rd√©s: <b id="qIdx">1</b>/15</span>
          <span class="badge">Pont: <b id="qScore">0</b></span>
          <span class="badge">Id≈ë: <b id="qTime">0.0s</b></span>
          <div class="meter"><span id="qBar"></span></div>
        </div>
        <div id="quizQWrap" style="display:none">
          <div id="qText" class="box" style="color:#111">K√©rd√©s‚Ä¶</div>
          <div id="qAns" class="answers"></div>
        </div>
        <div id="quizDone" style="display:none">
          <h3 style="margin:6px 0">Eredm√©ny</h3>
          <div class="box" id="quizSummary" style="color:#111"></div>
          <div class="row" style="margin-top:10px">
            <button id="quizAgain" class="chip info">√öjra</button>
            <button id="quizReset" class="chip" style="background:#fff;color:#111">Toplista t√∂rl√©se</button>
          </div>
        </div>
        <div style="margin-top:14px">
          <h4 style="margin:0 0 6px;color:#111">Toplista (helyi)</h4>
          <table style="width:100%;border-collapse:collapse">
            <thead><tr><th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px;color:#111">#</th><th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px;color:#111">N√©v</th><th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px;color:#111">Pont</th><th style="text-align:left;border-bottom:1px solid #e5e7eb;padding:6px;color:#111">Id≈ë</th></tr></thead>
            <tbody id="lbBody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Am≈ëba -->
  <div class="window" id="winTtt" style="top:110px; left:700px; width:380px;">
    <div class="titlebar"><span class="dot red"></span><span class="dot yellow"></span><span class="dot green"></span><div class="title">Am≈ëba</div></div>
    <div class="win-content">
      <div class="ttt-grid" id="tttGrid"></div>
      <div id="tttInfo" class="box" style="margin-top:10px;text-align:center">Te kezdesz: X</div>
      <div class="ttt-panel">
        <button id="tttReset" class="chip info">√öjrakezd</button>
        <label class="row" style="gap:6px">
          <input type="checkbox" id="tttCpu" checked>
          <span class="muted">J√°t√©k a g√©p ellen</span>
        </label>
      </div>
    </div>
  </div>

  <!-- Chat -->
  <div class="window" id="winChat" style="top:360px; left:40px; width:520px;">
    <div class="titlebar"><span class="dot red"></span><span class="dot yellow"></span><span class="dot green"></span><div class="title">Chat</div></div>
    <div class="win-content">
      <div id="chatBox" class="chat-box"></div>
      <div class="chat-input">
        <input id="chatInput" type="text" placeholder="√çrj valamit‚Ä¶ (szia, vicc, seg√≠ts)">
        <button id="chatSend" class="chip ok">K√ºld√©s</button>
      </div>
    </div>
  </div>

  <!-- Hangok + Id≈ëj√°r√°s -->
  <div class="window" id="winMedia" style="top:360px; left:600px; width:420px;">
    <div class="titlebar"><span class="dot red"></span><span class="dot yellow"></span><span class="dot green"></span><div class="title">Hangok & Id≈ëj√°r√°s</div></div>
    <div class="win-content">
      <div class="row" style="margin-bottom:8px">
        <button class="chip ok" data-sound="prank">Prank ‚ñ∂Ô∏è</button>
        <button class="chip info" data-sound="talent">Tehets√©ges ‚ñ∂Ô∏è</button>
        <button class="chip" id="stopAll">Le√°ll√≠t</button>
      </div>
      <div class="row">
        <button id="btnWx" class="chip ok">Po√©nos id≈ëj√°r√°s</button>
        <div id="wx" class="box">Nyomd meg a gombot!</div>
      </div>
      <div class="row" style="margin-top:8px">
        <div class="box" id="clock">--:--:--</div>
      </div>
    </div>
  </div>
</div>

<!-- Hangf√°jlok -->
<audio id="prank"  src="prank_short.mp3"    preload="auto"></audio>
<audio id="talent" src="tehetseges.mp3.m4a" preload="auto"></audio>

<!-- Three.js CDN a 3D h√°tt√©rhez -->
<script src="https://unpkg.com/three@0.157.0/build/three.min.js"></script>

<script>
window.addEventListener('DOMContentLoaded', () => {
  const $ = s => document.querySelector(s);
  const $$ = s => document.querySelectorAll(s);
  const rnd = a => a[Math.floor(Math.random()*a.length)];

  /* ===== 3D h√°tt√©r ‚Äì r√©szecskefelh≈ë ===== */
  (function init3D(){
    const canvas = document.getElementById('bg3d'); if(!canvas) return;
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(60, innerWidth/innerHeight, 1, 2000);
    camera.position.z = 500;
    const renderer = new THREE.WebGLRenderer({canvas, antialias:true});
    function resize(){ renderer.setSize(innerWidth, innerHeight); camera.aspect = innerWidth/innerHeight; camera.updateProjectionMatrix(); }
    resize(); addEventListener('resize', resize);

    const COUNT = 1800;
    const geom = new THREE.BufferGeometry();
    const positions = new Float32Array(COUNT*3);
    for(let i=0;i<COUNT;i++){
      positions[i*3+0] = (Math.random()-0.5)*1200;
      positions[i*3+1] = (Math.random()-0.5)*800;
      positions[i*3+2] = (Math.random()-0.5)*1200;
    }
    geom.setAttribute('position', new THREE.BufferAttribute(positions,3));
    const material = new THREE.PointsMaterial({ size:2, color:0x88ccff, transparent:true, opacity:0.9 });
    const points = new THREE.Points(geom, material);
    scene.add(points);

    let t=0, mx=0, my=0;
    addEventListener('mousemove', e=>{ mx=(e.clientX/innerWidth - .5); my=(e.clientY/innerHeight - .5); });
    function anim(){
      t+=0.0025;
      points.rotation.y += 0.0015 + mx*0.005;
      points.rotation.x = my*0.15;
      material.color.setHSL((0.6 + Math.sin(t)*0.2)%1, 0.7, 0.6);
      renderer.render(scene, camera);
      requestAnimationFrame(anim);
    }
    anim();
  })();

  /* ===== Login stabil ===== */
  const form = $('#form'), loading = $('#loading'), loadingText = $('#loadingText');
  const loginWrap = $('#loginWrap'), appbar = $('#appbar'), dock = $('#dock'), profileName = $('#profileName');
  if(form && loading && loginWrap && appbar && dock){
    form.addEventListener('submit', (e)=>{
      e.preventDefault();
      const name = $('#name')?.value.trim();
      const email= $('#email')?.value.trim();
      const pwd  = $('#pwd')?.value.trim();
      const err  = $('#err');
      if(err) err.textContent='';
      if(!name || !email?.includes('@') || !pwd || pwd.length<4){ if(err) err.textContent='Ellen≈ërizd a mez≈ëket!'; return; }

      loading.style.display='grid';
      const texts = ["K√°v√©szemek ≈ërl√©se‚Ä¶","V√≠z meleg√≠t√©se‚Ä¶","Cs√©sze el≈ëk√©sz√≠t√©se‚Ä¶","Humor ellen≈ërz√©se‚Ä¶"];
      let i=0; const iv=setInterval(()=>{ loadingText.textContent=texts[i++%texts.length]; }, 800);

      setTimeout(()=>{
        clearInterval(iv); loading.style.display='none';
        loginWrap.style.display='none';
        appbar.style.display='flex';
        dock.style.display='flex';
        if(profileName) profileName.textContent = "√údv, " + (name || "Vend√©g") + "!";
        $('#desktop').style.display='block';
        // k√∂z√©pre rendez√©s els≈ë indul√°skor
        centerAll();
      }, 1200);
    });
  }

  /* ===== Dock gombok ablaknyit√°shoz ===== */
  $$('#dock [data-open]').forEach(btn=>{
    btn.addEventListener('click', ()=>{
      const target = $(btn.getAttribute('data-open')); if(!target) return;
      target.style.display='block'; bringToFront(target);
    });
  });
  $('#btnCenter')?.addEventListener('click', centerAll);

  /* ===== Drag & Z-index ===== */
  let zCounter = 10;
  function bringToFront(win){ win.style.zIndex = ++zCounter; }
  $$('.window').forEach(win=>{
    const bar = win.querySelector('.titlebar'); if(!bar) return;
    let sx=0, sy=0, ox=0, oy=0, dragging=false;
    bar.addEventListener('mousedown', e=>{ dragging=true; bringToFront(win); sx=e.clientX; sy=e.clientY; const r=win.getBoundingClientRect(); ox=r.left; oy=r.top; document.body.style.userSelect='none'; });
    window.addEventListener('mousemove', e=>{ if(!dragging) return; const nx=ox+(e.clientX-sx); const ny=oy+(e.clientY-sy); win.style.left = Math.max(8, Math.min(innerWidth - win.offsetWidth - 8, nx)) + 'px'; win.style.top = Math.max(60, Math.min(innerHeight - 80, ny)) + 'px';});
    window.addEventListener('mouseup', ()=>{ dragging=false; document.body.style.userSelect='auto'; });
    win.addEventListener('mousedown', ()=>bringToFront(win));
  });
  function centerAll(){
    const wins=[ '#winQuiz', '#winTtt', '#winChat', '#winMedia' ].map(id=>$(id)).filter(Boolean);
    let x=40, y=90;
    wins.forEach(w=>{ w.style.left=x+'px'; w.style.top=y+'px'; w.style.display='block'; bringToFront(w); x+=40; y+=30; });
  }

  /* ===== Hangok + Id≈ëj√°r√°s ===== */
  const A_PRANK=$('#prank'), A_TALENT=$('#talent');
  function stopAll(){ try{A_PRANK?.pause(); A_TALENT?.pause();}catch{} }
  function playById(id){
    stopAll();
    const a = id==='talent' ? A_TALENT : A_PRANK;
    if(!a) return; a.currentTime=0;
    a.play?.().catch(()=>alert('Kattints az oldalra, hogy a b√∂ng√©sz≈ë engedje a hangot!'));
  }
  $$('[data-sound]').forEach(b=>b.addEventListener('click',()=>playById(b.getAttribute('data-sound'))));
  $('#stopAll')?.addEventListener('click', stopAll);
  $('#btnWx')?.addEventListener('click', ()=>{ const WX=["Ma 100% es√©ly van po√©nz√°porra! ‚òîüòÇ","Holnap naps√ºt√©s √©s r√∂h√∂g√©shull√°m v√°rhat√≥. üåûü§£","Viharos nevet√©s k√∂zeleg! üí®üòÜ","Der√ºlt √©g, de a szomsz√©d viccei bebor√≠tanak. üå§","Nevet√©si front: mosoly √©szlelve. üå¶"]; const wx=$('#wx'); if(wx) wx.textContent=rnd(WX); });
  (function tick(){ const d=new Date(); const c=$('#clock'); if(c) c.textContent=d.toLocaleTimeString('hu-HU',{hour12:false}); requestAnimationFrame(tick); })();

  /* ===== Chat ===== */
  const chatBox=$('#chatBox'), chatInput=$('#chatInput'), chatSend=$('#chatSend');
  if(chatBox && chatInput && chatSend){
    function pushMsg(text,who='user'){ const b=document.createElement('div'); b.className='msg '+(who==='user'?'user':'bot'); b.textContent=text; chatBox.appendChild(b); chatBox.scrollTop=chatBox.scrollHeight; }
    const botFallback=["√ârtem‚Ä¶ vagy m√©gsem? ü§î Mes√©lj t√∂bbet!","K√°v√© ut√°n minden jobb. K√©rsz? ‚òï","Mondan√©k egy viccet, de f√©lek, hogy a b√∂ng√©sz≈ëd lefagy a nevet√©st≈ël.","Ha ez egy rejtv√©ny, akkor J√ìL csin√°lod. üòÑ","Hmm‚Ä¶ √©rdekes. N√©zd meg a Kv√≠zt!"];
    const botVicc=["Mi√©rt vitt a sz√°m√≠t√≥g√©p eserny≈ët? ‚Äì V√≠rusos id≈ë lesz.","Mit mond a nulla a nyolcasnak? ‚Äì Sz√©p √∂ved van!","A k√°v√© a v√°lasz. Mi is volt a k√©rd√©s? ü§î"];
    function botReply(t0){
      const t=t0.toLowerCase();
      if(/szia|hell√≥|hello|hali/.test(t)) return "Szia! A 3D r√©szecsk√©im is k√∂sz√∂nnek. üòé";
      if(/hogy vagy\??/.test(t)) return "Remek√ºl! Mint a FPS a gamer g√©pen. üöÄ";
      if(/vicc|po[e√©]n/.test(t)) return rnd(botVicc);
      if(/k[a√°]v[e√©]/.test(t)) return "K√°v√©? Mindig! ‚òï Addig kv√≠z vagy am≈ëba?";
      if(/seg[i√≠]ts|help|hogyan/.test(t)) return "Seg√≠tek: alul a dokkban nyisd meg az ablakokat. H√∫zogatni is lehet ≈ëket!";
      if(/j[a√°]t[e√©]k|game/.test(t)) return "Kv√≠z? Am≈ëba? Vagy mindkett≈ë! üéÆ";
      if(/\?$/.test(t)) return "J√≥ k√©rd√©s! Ha √©n tudn√°m, m√°r shaderbe is be√©gettem volna. ü§ñ";
      return rnd(botFallback);
    }
    function sendChat(){ const val=chatInput.value.trim(); if(!val) return; pushMsg(val,'user'); chatInput.value=''; setTimeout(()=>pushMsg(botReply(val),'bot'),350); }
    chatSend.addEventListener('click', sendChat);
    chatInput.addEventListener('keydown', e=>{ if(e.key==='Enter') sendChat(); });
  }

  /* ===== Kv√≠z ===== */
  const QUESTIONS=[
    {q:"Melyik √°llat alszik a legt√∂bbet?",a:["Koala","Oroszl√°n","Macska","Panda"],c:0},
    {q:"Melyik bolyg√≥ a ‚Äûv√∂r√∂s‚Äù?",a:["Mars","V√©nusz","Jupiter","Szaturnusz"],c:0},
    {q:"Mennyi 9√ó7?",a:["56","63","72","49"],c:1},
    {q:"Mi a H2O?",a:["Oxig√©n","Hidrog√©n","V√≠z","S√≥sav"],c:2},
    {q:"Melyik f≈ëv√°ros? B√©cs",a:["Sv√°jc","Ausztria","Belgium","Csehorsz√°g"],c:1},
    {q:"Melyik n√∂v√©ny f≈±szer?",a:["Bazsalikom","Ny√≠rfa","Feny≈ë","T√∂lgy"],c:0},
    {q:"HTML-ben linket melyik tag?",a:["<div>","<a>","<link>","<p>"],c:1},
    {q:"Mennyi a œÄ kb.?",a:["2.14","3.14","3.41","4.13"],c:1},
    {q:"Melyik nem programnyelv?",a:["Python","Ruby","Photoshop","Go"],c:2},
    {q:"Magyarorsz√°g f≈ëv√°rosa?",a:["Debrecen","Gy≈ër","Budapest","Szeged"],c:2},
    {q:"RGB-ben a B?",a:["Black","Blue","Brown","Bright"],c:1},
    {q:"H√°ny nap egy h√©t?",a:["5","6","7","8"],c:2},
    {q:"Melyik reptet?",a:["Strucc","Sas","Pingvin","Kivi"],c:1},
    {q:"HTTP S bet≈±je?",a:["Secure","Simple","Serial","Service"],c:0},
    {q:"CSS mire j√≥?",a:["Adatb√°zis","St√≠lus","Szerver","Teszt"],c:1},
  ];
  const lbKey='quizLeaderboardV1';
  const lbBody = $('#lbBody');
  function loadLB(){ try{return JSON.parse(localStorage.getItem(lbKey)||'[]')}catch{return []} }
  function saveLB(arr){ localStorage.setItem(lbKey, JSON.stringify(arr.slice(0,20))); }
  function formatTime(ms){ return (ms/1000).toFixed(1)+'s'; }
  function renderLB(){
    if(!lbBody) return;
    const lb = loadLB().sort((a,b)=> (b.score - a.score) || (a.time - b.time));
    lbBody.innerHTML = lb.slice(0,10).map((r,i)=>`<tr><td style="padding:6px;border-bottom:1px solid #e5e7eb">${i+1}</td><td style="padding:6px;border-bottom:1px solid #e5e7eb">${r.name||'N√©vtelen'}</td><td style="padding:6px;border-bottom:1px solid #e5e7eb">${r.score}/15</td><td style="padding:6px;border-bottom:1px solid #e5e7eb">${formatTime(r.time)}</td></tr>`).join('') || '<tr><td colspan="4" style="padding:6px;color:#555">M√©g nincs eredm√©ny.</td></tr>';
  }
  renderLB();

  const quizStart=$('#quizStart'), quizHud=$('#quizHud'), quizQWrap=$('#quizQWrap'), quizDone=$('#quizDone');
  const qIdxEl=$('#qIdx'), qScoreEl=$('#qScore'), qTimeEl=$('#qTime'), qBar=$('#qBar'), qText=$('#qText'), qAns=$('#qAns'), quizSummary=$('#quizSummary');

  if($('#quizGo')){
    let qi=0,qScore=0,qStart=0,qTimer=null,qEndAt=0,player='';
    $('#quizGo').addEventListener('click', startQuiz);
    $('#quizAgain')?.addEventListener('click', ()=>{ if(quizStart&&quizDone){ quizStart.style.display='block'; quizDone.style.display='none'; }});
    $('#quizReset')?.addEventListener('click', ()=>{ if(confirm('Biztos t√∂rl√∂d a toplist√°t?')){ localStorage.removeItem(lbKey); renderLB(); }});

    function startQuiz(){
      player = ($('#playerName')?.value || $('#name')?.value || 'Vend√©g').trim();
      qi=0; qScore=0;
      if(quizStart) quizStart.style.display='none';
      if(quizDone) quizDone.style.display='none';
      if(quizHud) quizHud.style.display='flex';
      if(quizQWrap) quizQWrap.style.display='block';
      qStart = performance.now();
      nextQuestion();
    }
    function nextQuestion(){
      if(qi>=QUESTIONS.length){ return finishQuiz(); }
      const Q=QUESTIONS[qi];
      if(qIdxEl) qIdxEl.textContent=(qi+1);
      if(qScoreEl) qScoreEl.textContent=qScore;
      if(qText) qText.textContent=Q.q;
      if(qAns){ qAns.innerHTML='';
        Q.a.forEach((txt,idx)=>{ const b=document.createElement('button'); b.className='ans'; b.textContent=txt; b.addEventListener('click',()=>choose(idx)); qAns.appendChild(b); });
      }
      const D=15000; qEndAt=performance.now()+D; if(qTimer) cancelAnimationFrame(qTimer);
      (function tickBar(){
        const left=Math.max(0,qEndAt-performance.now());
        if(qBar) qBar.style.transform=`scaleX(${left/D})`;
        if(qTimeEl) qTimeEl.textContent=((performance.now()-qStart)/1000).toFixed(1)+'s';
        if(left<=0){ lock(false); setTimeout(()=>{ qi++; nextQuestion(); },600);} else { qTimer=requestAnimationFrame(tickBar); }
      })();
      function choose(idx){ if(qTimer){cancelAnimationFrame(qTimer); qTimer=null;} const ok=(idx===Q.c); if(ok) qScore++; lock(ok,idx); setTimeout(()=>{qi++;nextQuestion();},600); }
      function lock(ok,picked=-1){ if(!qAns) return; [...qAns.children].forEach((btn,i)=>{ if(i===Q.c) btn.classList.add('correct'); if(i===picked&&i!==Q.c) btn.classList.add('wrong'); btn.disabled=true; }); }
    }
    function finishQuiz(){
      if(qTimer){ cancelAnimationFrame(qTimer); qTimer=null; }
      const totalMs=performance.now()-qStart;
      if(quizHud) quizHud.style.display='none';
      if(quizQWrap) quizQWrap.style.display='none';
      if(quizDone) quizDone.style.display='block';
      if(quizSummary) quizSummary.innerHTML=`<p><b>${player}</b>, eredm√©nyed: <b>${qScore}/15</b>, id≈ë: <b>${(totalMs/1000).toFixed(1)}s</b>.</p>`;
      const lb=loadLB(); lb.push({name:player,score:qScore,time:totalMs,date:Date.now()}); saveLB(lb.sort((a,b)=> (b.score-a.score) || (a.time-b.time))); renderLB();
    }
  }

  /* ===== Am≈ëba ===== */
  const tttGrid=$('#tttGrid'), tttInfo=$('#tttInfo'), tttCpu=$('#tttCpu');
  if(tttGrid && tttInfo){
    let board, playerTurn, gameOver;
    function initTTT(){ board=Array(9).fill(null); playerTurn='X'; gameOver=false; tttGrid.innerHTML=''; for(let i=0;i<9;i++){ const c=document.createElement('div'); c.className='ttt-cell'; c.addEventListener('click',()=>tttPlay(i)); tttGrid.appendChild(c);} tttInfo.textContent="Te kezdesz: X"; }
    function winLines(){return [[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];}
    function winner(){ for(const [a,b,c] of winLines()){ if(board[a]&&board[a]===board[b]&&board[a]===board[c]) return {p:board[a],line:[a,b,c]}; } if(board.every(Boolean)) return {p:'D',line:[]}; return null; }
    const pick = a => a[Math.floor(Math.random()*a.length)];
    function bestMove(mark){
      const opp=mark==='X'?'O':'X';
      for(let i=0;i<9;i++){ if(!board[i]){ board[i]=mark; if(winner()?.p===mark){ board[i]=null; return i;} board[i]=null; } }
      for(let i=0;i<9;i++){ if(!board[i]){ board[i]=opp;  if(winner()?.p===opp ){ board[i]=null; return i;} board[i]=null; } }
      if(!board[4]) return 4; const corners=[0,2,6,8].filter(i=>!board[i]); if(corners.length) return pick(corners); const sides=[1,3,5,7].filter(i=>!board[i]); if(sides.length) return pick(sides); return board.findIndex(v=>!v);
    }
    function tttPlay(i){
      if(gameOver||board[i])return; board[i]=playerTurn; renderTTT(); const w=winner(); if(w){end(w);return;}
      if(tttCpu?.checked){ playerTurn='O'; setTimeout(()=>{ const mv=bestMove('O'); if(mv>=0&&!gameOver){ board[mv]='O'; renderTTT(); const w2=winner(); if(w2){end(w2);return;} playerTurn='X'; tttInfo.textContent="Te j√∂ssz: X"; }},250);
      } else { playerTurn=(playerTurn==='X'?'O':'X'); tttInfo.textContent=`K√∂vetkez≈ë: ${playerTurn}`; }
    }
    function renderTTT(){ [...tttGrid.children].forEach((cell,i)=>{ cell.textContent=board[i]||''; cell.classList.remove('win'); }); }
    function end(res){ gameOver=true; if(res.p==='D'){ tttInfo.textContent="D√∂ntetlen!"; return; } res.line.forEach(idx=>tttGrid.children[idx].classList.add('win')); if(res.p==='X'){ tttInfo.textContent="Gratul√°lok, √ºgyes vagy! üéâ Te nyert√©l!"; } else tttInfo.textContent="A g√©p nyert. √öjra?"; }
    $('#tttReset')?.addEventListener('click', initTTT); initTTT();
  }
});
</script>
</body>
</html>

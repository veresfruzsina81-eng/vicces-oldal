<script>
  const form  = document.getElementById('form');
  const err   = document.getElementById('err');
  const ok    = document.getElementById('ok');
  const uname = document.getElementById('uname');
  const audio = document.getElementById('prank');
  const play  = document.getElementById('play');
  const back  = document.getElementById('back');
  const loading = document.getElementById('loading');
  const loadingText = loading.querySelector("p");

  // Vicces üzenetek listája
  const funnyMessages = [
    "Kávészemek őrlése…",
    "Cukor kimérése…",
    "Habos tej előkészítése…",
    "Kávé lefőzése…",
    "Illat ellenőrzése…",
    "Pohár előmelegítése…",
    "Utolsó kevergetés…",
    "Kávé kész! ☕"
  ];

  let msgIndex = 0;
  let msgInterval;

  function valid() {
    form.email.value = (form.email.value||'').trim();
    if(!form.checkValidity()){ form.reportValidity(); return false; }
    return true;
  }

  form.addEventListener('submit', async (e)=>{
    e.preventDefault();
    err.textContent = '';
    if(!valid()) return;

    // ☕ megjelenítjük a kávéfőző overlayt
    loading.style.display = 'grid';

    // Indítjuk a vicces üzenet-rotációt
    msgIndex = 0;
    loadingText.textContent = funnyMessages[msgIndex];
    msgInterval = setInterval(()=>{
      msgIndex++;
      if(msgIndex < funnyMessages.length){
        loadingText.textContent = funnyMessages[msgIndex];
      }
    }, 500);

    // szimulált „feldolgozás” (4s)
    await new Promise(r=>setTimeout(r, 4000));

    // leállítjuk az üzenetváltást
    clearInterval(msgInterval);

    // overlay el
    loading.style.display = 'none';

    // siker képernyő + hang
    uname.textContent = (form.name.value||'').trim();
    form.style.display = 'none';
    ok.style.display = 'block';

    try { audio.currentTime = 0; await audio.play(); }
    catch {
      // ha blokkolt az autoplay, első kattintásra indul
      document.body.addEventListener('click', ()=>audio.play(), {once:true});
    }
  });

  play?.addEventListener('click', (e)=>{ e.preventDefault(); try{ audio.currentTime=0; audio.play(); }catch{} });
  back?.addEventListener('click', (e)=>{
    e.preventDefault();
    ok.style.display='none';
    form.reset();
    <!doctype html>
<meta charset="utf-8">
<title>Smoke test</title>
<h1>OK ✅</h1>
<p>Ha ezt látod, a domain és a deploy rendben van.</p>
    form.style.display='block';
    try{ audio.pause(); }catch{}
  });
</script>
